<!doctype html>
<html>
<head>
    <title>eStat: Stat Education SW</title>
    <meta charset='utf-8'>
    <link rel="stylesheet" href="css/eStat.css">
    <link rel="stylesheet" href="css/handsontable.full.min.css">
    <link rel="stylesheet" href="lib/jquery/jquery-ui.min.css">
    <script src="lib/d3/d3.v4.min.js"></script>
    <script src="lib/jquery/jquery-3.2.1.min.js"></script>
    <script src="lib/jquery/jquery-ui.min.js"></script>        
    <script src="lib/handsontable/handsontable.full.min.js"></script>
    <script src="lib/FileSaver.min.js" ></script>
    <script src="lib/DistributionsUtil.js" ></script>
    <script src="lib/convertSVG.js"></script>   
    <script src="js/eStat.js" ></script>
</head>
<body>


  <div id="screenTop" > 
    <div id="screenTopLeft" style="position:absolute; top:20px; ">
      <div class="tooltip" > &nbsp;
        <img src="img/example.png" id="exBtn" class="imageBtn1" >
        <span class="tooltiptext">Example</span>
      </div>
      <div class="tooltip">
        <img src="img/01.png" id="new" width="38px" height="38px">
        <span class="tooltiptext">New Sheet</span>
      </div>  
      <div class="tooltip">
        <img src="img/02csv.png" id="icon_importCSV" width="38px" height="38px">
        <span class="tooltiptext">csv Open</span>
        <input type="file" accept=".csv" onchange="importCSV(this)" style="display:none" id="importCSV">	
      </div>  
      <div class="tooltip">
        <img src="img/03csv.png" id="exportCSV" width="38px" height="38px">
        <span class="tooltiptext">csv Save</span>
      </div>  
      <div class="tooltip">
        <img src="img/02.png" id="open" width="38px" height="38px">
        <span class="tooltiptext">json Open</span>
        <input type="file" accept=".json" onchange="loadFile(this)" style="display:none" id="input_openFile">
      </div> 
      <div class="tooltip">
        <img src="img/03.png" id="save" width="38px" height="38px">
        <span class="tooltiptext">json Save</span>
      </div>  
      <div class="tooltip">
        <img src="img/04.png" id="printSheet" width="38px" height="38px">
        <span class="tooltiptext">Print Sheet</span>
      </div>  
    </div>

    <div id="screenTopMiddle1" style="position:absolute; left:410px; top:20px; ">
      <div class="tooltip">
        <img src="img/v1_type.png" id="separate1" class="imageBtn1">
        <span class="tooltiptext">Bar Graph</span>
      </div>  
      <div class="tooltip">
        <img src="img/pie_type.png"    id="pie1" class="imageBtn1">
        <span class="tooltiptext">Pie Chart</span>
      </div>   
      <div class="tooltip">
        <img src="img/stack2_type.png" id="band1" class="imageBtn1">
        <span class="tooltiptext">Band Graph</span>
      </div> 
      <div class="tooltip">
        <img src="img/08.png"          id="line1" class="imageBtn1">
        <span class="tooltiptext">Line Graph</span>
      </div>   
    </div>

    <div id="screenTopMiddle2" style="position:absolute; left:590px; top:20px; ">
      &nbsp;
      <div class="tooltip">
        <img src="img/dot_icon.png"  id="dot1"  class="imageBtn1">
        <span class="tooltiptext">Dot Graph</span>
      </div>   
      <div class="tooltip">   
        <img src="img/histo_type.png" id="hist1" class="imageBtn1">
        <span class="tooltiptext">Histogram</span>
      </div>  
      <div class="tooltip">
        <img src="img/leaf_type.png" id="stem1" class="imageBtn1">
        <span class="tooltiptext">Stem & Leaf Plot</span>
      </div>
      <div class="tooltip">
        <img src="img/box_type2.png" id="box1"  class="imageBtn1">
        <span class="tooltiptext">Box Whisker Plot</span>
      </div> 
      <div class="tooltip">   
        <img src="img/scatter.png" id="scatter1" class="imageBtn1">
        <span class="tooltiptext">Scatter Plot</span>
      </div>
    </div>

    <div id="screenTopMiddle3" style="position:absolute; left:820px; top:20px; ">
      &nbsp;
      <div class="tooltip">
        <img src="img/0725_3.png" id="freqTable" class="imageBtn1">
        <span class="tooltiptext">Frequency Table</span>
      </div> 
      <div class="tooltip">   
        <img src="img/0725_1.png" id="statTable" class="imageBtn1"> 
        <span class="tooltiptext">Basic Statistics</span>
      </div> 
    </div>

    <div id="screenTopRight1" style="position:absolute; left:1010px; top:20px; ">
      <div class="tooltip">
        <img src="img/thmu.png" id="testM1" class="imageBtn3">
        <span class="tooltiptext">Testing &mu;</span>
      </div>  
      <div class="tooltip">
        <img src="img/thsigma.png" id="testS1" class="imageBtn3">
        <span class="tooltiptext">Testing &sigma;<sup>2</sup></span>
      </div>  
      <div class="tooltip">
        <img src="img/thmu12.png" id="testM12" class="imageBtn3">
        <span class="tooltiptext">Testing &mu;<sub>1</sub>, &mu;<sub>2</sub></span>
      </div>  
      <div class="tooltip">
        <img src="img/thsigma12.png" id="testS12" class="imageBtn3">
        <span class="tooltiptext">Testing &sigma;<sub>1</sub><sup>2</sup>, &sigma;<sub>2</sub><sup>2</sup></span>
      </div>  
      <div class="tooltip">
        <img src="img/anova.png" id="anova" class="imageBtn3">
        <span class="tooltiptext">ANOVA</span>
      </div>  
      <div class="tooltip" > 
        <img src="img/eStatH.png" id="estatH" class="imageBtn1">
        <span class="tooltiptext">High School Education</span>
      </div>
      <div class="tooltip" > 
        <img src="img/eStatU.png" id="estatU" class="imageBtn1">
        <span class="tooltiptext">University Education</span>
      </div>
    </div>

    <div id="screenTopRight2" style="position:absolute; left:1340px; top:20px; ">
      <div class="tooltip" > 
        <img src="img/graphEX.png" id="estatE" class="imageBtn1" >
        <span class="tooltiptext">Graph Example</span>
      </div> 
<!--
      <div class="tooltip" > 
        <img src="img/estat.png" id="estat" class="imageBtn1" >
        <span class="tooltiptext">eStat Learning</span>
      </div>
-->
    </div>

    <div id="screenTopRight3" style="position:absolute; left:1440px; top:20px; width:100">
      <form name="myForm1">
        <input type="button" value="Korean" id="langBtn" style="font-size: 14px; height;50px;"> <br>
        Level 
        <input type="radio" name = "type1" value="1" id="level1">E
        <input type="radio" name = "type1" value="2" id="level2">M
        <input type="radio" name = "type1" value="3" id="level3" checked>U
      </form>
    </div>

  </div>

  <div id="screenLeft" style="position:absolute; left:10px; top:72px;">
      <label id="inputLabel">
        File Name <input type="text" value="" id="loadFileName" height="15px" size=40> <br>
        Var Selected <input type="text" value="" id="select" height="15px" size=18> &nbsp;
        <input type="button" value="Cancel" id="debugBtn" style="font-size: 12px; height;20px;"> &nbsp;
        <input type="button" value="EditVar" id="variableBtn" style="font-size: 12px; height;20px;"> 
        <br>
      </label>
      <div id="datasheet" style="width:380px; height:675px; overflow: auto;"> </div>
  </div>

  <div id="screenMiddle" style="position:absolute; left:400px; top:80px;">

    <div id="screenSVGtop" style="position:relative; left:0px; top:0px">
        &nbsp;
        <div class="tooltip">
          <img src="img/v4_type.png" id="separate2V" class="imageBtn2">
          <span class="tooltiptext">Vertical Separate</span>
        </div>  
        <div class="tooltip">
          <img src="img/v2_type.png" id="stack2V" class="imageBtn2">
          <span class="tooltiptext">Vertical Stack</span>
        </div> 
        <div class="tooltip">
          <img src="img/v3_type.png" id="ratio2V" class="imageBtn2">
          <span class="tooltiptext">Vertical Ratio</span>
        </div>  
        <div class="tooltip">
          <img src="img/v6_type.png" id="side2V" class="imageBtn2">
          <span class="tooltiptext">Vertical SideBySide</span>
        </div>  
        <div class="tooltip">
          <img src="img/v5_type.png" id="bothbar2V" class="imageBtn2">
          <span class="tooltiptext">Vertical Two Sided</span>
        </div>
        <div class="tooltip">
          <img src="img/h4_type.png" id="separate2H" class="imageBtn2">
          <span class="tooltiptext">Horizontal Separate</span>
        </div>  
        <div class="tooltip">
          <img src="img/h2_type.png" id="stack2H" class="imageBtn2">
          <span class="tooltiptext">Horizontal Stack</span>
        </div> 
        <div class="tooltip">
          <img src="img/h3_type.png" id="ratio2H" class="imageBtn2">
          <span class="tooltiptext">Horizontal Ratio</span>
        </div>  
        <div class="tooltip">
          <img src="img/h6_type.png" id="side2H" class="imageBtn2">
          <span class="tooltiptext">Horizontal SideBySide</span>
        </div>  
        <div class="tooltip">
          <img src="img/h5_type.png" id="bothbar2H" class="imageBtn2">
          <span class="tooltiptext">Horizontal Two Sided</span>
        </div>
        <div class="tooltip">
          <img src="img/donut_type.png"  id="donut2" class="imageBtn2">
          <span class="tooltiptext">Donut Graph</span>
        </div>
        <div class="tooltip">
          <img src="img/leaf_type_both.png" id="bothstem2" class="imageBtn2">
          <span class="tooltiptext">Two-sided Stem-Leaf</span>
        </div>  
        &nbsp;&nbsp;   
        <div class="tooltip">
          <img src="img/03saveGraph.png" id="saveGraph" class="imageBtn2">
          <span class="tooltiptext">Graph Save</span>
        </div> 
        <div class="tooltip">
          <img src="img/04printGraph.png" id="printGraph" class="imageBtn2">
          <span class="tooltiptext">Graph Print</span>
        </div>  
        <div class="tooltip">
          <img src="img/03moveGraph.png" id="moveGraph" class="imageBtn2">
          <span class="tooltiptext">Graph Move to Log</span>
        </div> 
        <div class="tooltip">
          <img src="img/editGraph.png" id="editGraph" class="imageBtn2">
          <span class="tooltiptext">Edit Graph Title</span>
        </div>
    </div> <!-- end of SVGtop -->

    <div id="svgArea">
      <svg id="SVG" style="position:relative; left:0px; top:10px">  </svg> 
    </div>

    <div id="option" style="position:relative; left:0px; top:5px"> 
      <div id="sub1">
        <label>&nbsp;&nbsp;<input type="checkbox" id=freq>frequency</label> 
      </div>
      <form name="myForm2" >
        <div id="sub2">
        &nbsp;(Sorting) 
        <input type="radio" name = "type2" value="1" id="raw" checked>  Raw Data
        <input type="radio" name = "type2" value="2" id="descend">    Descending
        <input type="radio" name = "type2" value="3" id="ascend">     Ascending
        </div>
      </form>

      <div id="sub3">
        <label>&nbsp;<input type="checkbox" id=mean>&nbsp;frequency</label> <br> 
      </div>

      <form name="myForm3">
        <div id="sub4">
        &nbsp;(Sorting)&nbsp;
        <input type="radio" name = "type3" value="1" id="raw2" checked>  Raw Data
        <input type="radio" name = "type3" value="2" id="descend2">    Descending
        <input type="radio" name = "type3" value="3" id="ascend2">     Ascending <p>
        </div>
      </form>
 
      <div id="sub5">
        &nbsp; <label><input type="checkbox" id=DotMean> Mean</label>
        <label><input type="checkbox" id=DotStd>Standard Deviation</label> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      </div>

      <div id="sub6">
        &nbsp; <label><input type="checkbox" id="regress">regression line</label>  <br>
      </div>

      <div id="sub7">
        <label>&nbsp;<input type="checkbox" id=HistMean>Mean</label>
        <label><input type="checkbox" id=HistFreq>Frequency</label>
        <label><input type="checkbox" id=HistLine>Frequency Polygon</label> &nbsp
        <input type="button" value="Frequency Table", id=histTable> <br>
        &nbsp;<input type="button" value="Update with New Interval" id="HistRedraw">  &nbsp
        &nbsp;Interval Start <input type="text" class="textarea" value="0" size=4  id="HistInit"> &nbsp
        &nbsp;Interval Width <input type="text" class="textarea" value="10" size=4 id="HistStep"> <p>
      </div>

      <div id="sub8"> <!-- TH 1 Mean -->
       
        <form name="myForm80"> 
          <span class="fontmath">&nbsp;&nbsp;
            H<sub>o</sub> : &mu; = &mu;<sub>o</sub> &nbsp;
          </span>
          <input type="text" class="textarea" size=6 id="mu8"> 
          &nbsp;&nbsp;
          <span class="fontmath">
	    <input type="radio" name = "type0" value="1" checked>
	    H<sub>1</sub> : &mu; &ne;  &mu;<sub>o</sub> &nbsp;&nbsp;
	    <input type="radio" name = "type0" value="2" >
	    H<sub>1</sub> : &mu; > &mu;<sub>o</sub> &nbsp;&nbsp;      
	    <input type="radio" name = "type0" value="3" >
            H<sub>1</sub> : &mu; < &mu;<sub>o</sub>    
          </span>
        </form> 

        <form name="myForm81">&nbsp; &nbsp;
          <span class="fontmath">
            <input type="radio" name = "type1" value="2" checked> <span class="fontmath">t</span>-test
            <input type="radio" name = "type1" value="1" > Z-test       
          </span>
          &nbsp;&nbsp;&nbsp;
          <span class="fontmath">&sigma;</span> =
          <input type="text" class="textarea" size=6 id="std8"> &nbsp;
          <span class="fontguide">(if Z-test, input &sigma;)</span>
         </form>       

        <form name="myForm82">&nbsp; &nbsp;
          <span class="fontmath">
            significance level &nbsp; <span class="fontmath">&alpha;</span> = 
            <span>
            <input type="radio" name = "type2" value="1" checked> 5%       
            <input type="radio" name = "type2" value="2" > 1%
            </span>
          </span> 
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          <input type="button" value="ReExecute" size=12 id="executeTH8" style="background-color:white;">
        </form>   
                 
        <table>
          <tbody>
            <tr>
              <td colspan="5"><span class="fontmath">&nbsp; [Confidence Interval] </span> </td>
              <td>&nbsp;</td>
              <td><span class="fontmath">m</span></td>
              <td>&plusmn;</td>
              <td><span class="fontmath">t<sub>n-1, 1-&alpha;/2<sub></span></td>
              <td><span class="fontmath"> (s / &radic; n )</span></td>
              <td colspan="4"><span class="fontguide">(if Z-test, Z<sub>1-&alpha;/2 </sub> is used)</span> </td>
              <td>&nbsp;</td>
            </tr>
          </tbody>
        </table>
        
      </div>

      <div id="sub9">  <!-- TH 1 Variance -->
          
        <form name="myForm90"> 
          <span class="fontmath">&nbsp;&nbsp;
            H<sub>o</sub> : &sigma; <sup>2</sup> = &sigma;<sub>o</sub><sup>2</sup> &nbsp;
          </span>
          <input type="text" class="textarea" size=6 id="vari9"> 
          &nbsp;&nbsp;
          <span class="fontmath">
	    <input type="radio" name = "type0" value="1" checked>
	    H<sub>1</sub> : &sigma;<sup>2</sup> &ne;  &sigma;<sub>o</sub><sup>2</sup> &nbsp;&nbsp;
	    <input type="radio" name = "type0" value="2" >
	    H<sub>1</sub> : &sigma;<sup>2</sup> > &sigma;<sub>o</sub><sup>2</sup> &nbsp;&nbsp;      
	    <input type="radio" name = "type0" value="3" >
            H<sub>1</sub> : &sigma;<sup>2</sup> < &sigma;<sub>o</sub><sup>2</sup>    
          </span>
        </form>
  
        <form name="myForm92">&nbsp;&nbsp;&nbsp; 
          <span class="fontmath">&chi;<sup>2</sup> test </span>    
          <br> &nbsp;&nbsp;&nbsp;
          <span class="fontmath">
            significance level &nbsp; <span class="fontmath">&alpha;</span> = 
            <input type="radio" name = "type2" value="1" checked> 5%       
            <input type="radio" name = "type2" value="2" > 1%
          </span>
          &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
          <input type="button" value="ReExecute" size=12 id="executeTH9" style="background-color:white;">
        </form>       

        <table>
          <tbody>
            <tr>
              <td colspan="8"><span class="fontmath">&nbsp; [Confidence Interval] </span> </td>
              <td>&nbsp;</td>
	      <td><span class="fontmath">(&nbsp;(n-1)s<sup>2</sup> / &chi;<sup>2</sup> <sub>n-1,1-&alpha;/2</sub></span>&nbsp;,</td>
	      <td><span class="fontmath">(n-1)s<sup>2</sup> / &chi;<sup>2</sup> <sub>n-1,&alpha;/2</sub> &nbsp;)</span></td>
            </tr>
          </tbody>
        </table>

      </div>      

      <div id="sub10"> <!-- TH 2 Means -->
       
        <form name="myForm100"> 
          <span class="fontmath"> &nbsp;&nbsp; 
            H<sub>o</sub> : &mu;<sub>1</sub> - &mu;<sub>2</sub> = D &nbsp; 
          </span>
          <input type="text" class="textarea" value=0 size=6 id="mu10">&nbsp; 
          <span class="fontmath">
	    <input type="radio" name = "type0" value="1" checked>
	    H<sub>1</sub> : &mu;<sub>1</sub> - &mu;<sub>2</sub> &ne; D &nbsp;&nbsp;
	    <input type="radio" name = "type0" value="2" >
	    H<sub>1</sub> : &mu;<sub>1</sub> - &mu;<sub>2</sub> > D &nbsp;&nbsp;      
	    <input type="radio" name = "type0" value="3" >
            H<sub>1</sub> : &mu;<sub>1</sub> - &mu;<sub>2</sub> < D      
          </span>
        </form>
    
        <form name="myForm101"> 
          &nbsp; &nbsp; &nbsp;       
          <span class="fontmath">
          Assume 
          <input type="radio" name = "type1" value="1" checked>
          &sigma;<sub>1</sub><sup>2</sup> = &sigma;<sub>2</sub><sup>2</sup> &nbsp;&nbsp;
          <input type="radio" name = "type1" value="2" >
          &sigma;<sub>1</sub><sup>2</sup> &ne; &sigma;<sub>2</sub><sup>2</sup>  </span>  
          </span>
        </form>

        <form name="myForm102"> 
          &nbsp; &nbsp; &nbsp;
          <span class="fontmath">significance level  &nbsp;  &alpha; </span> =
          <span>
          <input type="radio" name = "type2" value="1" checked> 5%  &nbsp;      
          <input type="radio" name = "type2" value="2" > 1%
          </span>
          &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
          <input type="button" value="ReExecute" size=12 id="executeTH10" style="background-color:white;">
        </form>       

      </div>      

      <div id="sub11"> <!-- TH 2 Variances -->
   
        <form name="myForm110"> 
          <span class="fontmath"> &nbsp;&nbsp; 
             H<sub>o</sub> : &sigma;<sub>1</sub><sup>2</sup> = &sigma;<sub>2</sub><sup>2</sup>&nbsp;
          </span>
          &nbsp;&nbsp;
          <span class="fontmath" >
            <input type="radio" name = "type0" value="1" checked> 
              H<sub>1</sub> : &sigma;<sub>1</sub><sup>2</sup> &ne; &sigma;<sub>2</sub><sup>2</sup> &nbsp; &nbsp;     
            <input type="radio" name = "type0" value="2" > 
              H<sub>1</sub> : &sigma;<sub>1</sub><sup>2</sup>  >   &sigma;<sub>2</sub><sup>2</sup> &nbsp; &nbsp;     
            <input type="radio" name = "type0" value="3" >   
              H<sub>1</sub> : &sigma;<sub>1</sub><sup>2</sup>  <   &sigma;<sub>2</sub><sup>2</sup>
          </span>
        </form>

        <form name="myForm112">&nbsp;&nbsp;&nbsp; 
          <span class="fontmath">F  test </span>
          <br>
          &nbsp;&nbsp;&nbsp; 
          <span class="fontmath"> significance level &nbsp; &alpha; </span> = 
          <span>
          <input type="radio" name = "type2" value="1" checked> 5%       
          <input type="radio" name = "type2" value="2" > 1%
          </span>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          <input type="button" value="ReExecute" size=12 id="executeTH11" style="background-color:white;">
        </form>         

      </div>      

      <div id="sub12"> <!-- TH 1 Analysis of Variance -->
      
        <div class="fontmath">&nbsp;
          H<sub>o</sub> : &nbsp; &mu;<sub>1</sub> = &mu;<sub>2</sub> = ... = &mu;<sub>k</sub> &nbsp;&nbsp;
          H<sub>1</sub> : at least one pair of population means is not equal   
        </div> 
 
        <form name="myForm122">&nbsp;&nbsp;&nbsp; 
          <span class="fontmath">F  test </span>
          <br>
          &nbsp;&nbsp;&nbsp; 
          <span class="fontmath"> significance level &nbsp; &alpha; </span> = 
          <span>
          <input type="radio" name = "type2" value="1" checked> 5%       
          <input type="radio" name = "type2" value="2" > 1%
          </span>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          <input type="button" value="ReExecute" size=12 id="executeTH12" style="background-color:white;">
        </form>           
      </div>      

      <div id="sub13"> <!-- 그래프 제목 편집 -->
        <form>
          <p>
          &nbsp;&nbsp;주 제목 : <input type="text" id="titleMain" size="50">  <br>
          &nbsp;&nbsp;y축제목 : <input type="text" id="titleY" size="20">  <br>
          &nbsp;&nbsp;x축제목 : <input type="text" id="titleX" size="20">  
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          <input type="button" value="수정" size=12 id="executeTH13" style="background-color:white;">
        </form>           
      </div>  

      <div class="dialog" id="sub14"> <!-- 변수정보 편집 -->
        <div>         
          <select id="varlist" onchange="selectVarUpdate()"> 
             <option value="1">V1</option>
            <option value="2">V2</option>
            <option value="3">V3</option>
            <option value="4">V4</option>
            <option value="5">V5</option>
            <option value="6">V6</option>
            <option value="7">V7</option>
            <option value="8">V8</option>
            <option value="9">V9</option>
            <option value="10">V10</option>
          </select>
          &nbsp; Var Name : <input type="text" size=10 id="vname" >
        </div>

        <table>
          <tbody>
            <tr>
              <td>&nbsp;</td>
              <td>#</td>
              <td>Var Value</td>
              <td>Value Label</td>
            </tr>
            <tr>
              <td>&nbsp;</td>
              <td>1</td>
              <td><input type="text" size=5 id="cell11" ></td>
              <td><input type="text" size=8 id="cell12" ></td>
            </tr>
            <tr>
              <td>&nbsp;</td>
              <td>2</td>
              <td><input type="text" size=5 id="cell21" ></td>
              <td><input type="text" size=8 id="cell22" ></td>
            </tr>
            <tr>
              <td>&nbsp;</td>
              <td>3</td>
              <td><input type="text" size=5 id="cell31" ></td>
              <td><input type="text" size=8 id="cell32" ></td>
            </tr>
            <tr>
              <td>&nbsp;</td>
              <td>4</td>
              <td><input type="text" size=5 id="cell41" ></td>
              <td><input type="text" size=8 id="cell42" ></td>
            </tr>
            <tr>
              <td>&nbsp;</td>
              <td>5</td>
              <td><input type="text" size=5 id="cell51" ></td>
              <td><input type="text" size=8 id="cell52" ></td>
            </tr>
            <tr>
              <td>&nbsp;</td>
              <td>6</td>
              <td><input type="text" size=5 id="cell61" ></td>
              <td><input type="text" size=8 id="cell62" ></td>
            </tr>
            <tr>
              <td>&nbsp;</td>
              <td>7</td>
              <td><input type="text" size=5 id="cell71" ></td>
              <td><input type="text" size=8 id="cell72" ></td>
            </tr>
            <tr>
              <td>&nbsp;</td>
              <td>8</td>
              <td><input type="text" size=5 id="cell81" ></td>
              <td><input type="text" size=8 id="cell82" ></td>
            </tr>
            <tr>
              <td>&nbsp;</td>
              <td>9</td>
              <td><input type="text" size=5 id="cell91" ></td>
              <td><input type="text" size=8 id="cell92" ></td>
            </tr>
          </tbody>
        </table>
        <h5>&nbsp;&nbsp; * Value labels are allowed at most 9 values of a variable </h5>
        &nbsp;&nbsp; <input type="button" value="Save" id="vconfirm"  size="10">
        &nbsp;&nbsp; <input type="button" value="Exit" id="vcancel" size="10" >

      </div>

    </div> 
  </div> 
  
  <div id="screenTableTop" style="position:absolute; left:1010px; top:80px; width: 600px; height:30px; border:1px solid black; background-color:#f1f1f1;">
        &nbsp;
        <div class="tooltip" style="position:relative; left:0px; top:0px; "> 
          <img src="img/03saveTable.png" id="saveTable" class="imageBtn2">
          <span class="tooltiptext">Save Table</span>
        </div>   
        <div class="tooltip" style="position:relative; left:0px; top:0px; "> 
          <img src="img/04printTable.png" id="printTable" class="imageBtn2">
          <span class="tooltiptext">Print Table</span>
        </div>  
  </div> 

  <div id="screenTable" style="position:absolute; left:1010px; top:122px; width: 600px; height:670px; border:1px solid black; overflow: auto;"> 
    <div id="loc">
    </div>  
  </div>

 
<script>

      var chart = d3.select("#SVG");

      // 기본 버튼 칼러색 설정
      var buttonColorB = "#E0FFFF";
      var buttonColorH = "#FF4500";

      // 메뉴 칼러
      var exampleDataNo = 10
      var menuColor = new Array(exampleDataNo+1);

      var i, j, k, m, temp, tempi;
      var freqMin, freqMax, numVar, rawData, checkNumeric, checkVarSelect; 
      var svgWidth, svgHeight, margin, graphWidth, graphHeight;
      var svgWidth2, svgHeight2;
      var title, graphNum;
      var langNum      = 1;
      var rowMax       = 100;  // 시트행 최대
      var colMax       = 10;   // 시트열 최대
      var buffer       = 20;   // 우측 y선과 범례와  간격
      var bothBarGap   = 35;   // 양쪽막대의 갭
      var maxNumEdit   = 9;    // 변량편집시 최대 변량값 수
      var jj           = 0;    // 변량편집시 초기 컬럼 번호
      var graphNumMax  = 26;   // 그래프 종류의 최대 개수  현재 25개

      // 그래프별 초기제목, 주제목, x제목, y제목
      var iTitle      = new Array(graphNumMax);
      var mTitle      = new Array(graphNumMax);
      var yTitle      = new Array(graphNumMax);
      var xTitle      = new Array(graphNumMax);

      // datasheet raw variable
      var numCol, numRow;
      var robs        = new Array(colMax);
      var rvarName    = new Array(colMax);
      var rvarDeci    = new Array(colMax);
      var rvalueNum   = new Array(colMax);
      var rvar        = new Array(colMax);  // 2차원 배열로 아래에 정의
      var rvalue      = new Array(colMax);  // 2차원 배열로 아래에 정의
      var rvalueLabel = new Array(colMax);  // 2차원 배열로 아래에 정의

      // selected variable for analysis
      var tdobs        = new Array(colMax);
      var tdvarNumber  = new Array(colMax);
      var tdvarName    = new Array(colMax);
      var tdvalueNum   = new Array(colMax);
      var tdvar        = new Array(colMax);  // 2차원 배열로 아래에 정의
      var tdvalue      = new Array(colMax);  // 2차원 배열로 아래에 정의
      var tdvalueLabel = new Array(colMax);  // 2차원 배열로 아래에 정의

      for (j = 0; j < colMax; j++) {
          rvarName[j]     = "V"+(j+1).toString();
          rvar[j]         = new Array(rowMax);
          rvalue[j]       = new Array(rowMax);
          rvalueLabel[j]  = new Array(rowMax);
          tdvar[j]        = new Array(rowMax);
          tdvalue[j]      = new Array(rowMax);
          tdvalueLabel[j] = new Array(rowMax);
          for (i = 0; i < rowMax; i++) {
            rvalueLabel[j][i]  = null; 
            tdvalueLabel[j][i] = null;
          }
     }

      // Sorting freq and Ascend/Descend Indexing Label
      var dataR   = new Array(rowMax);
      var dataA   = new Array(rowMax);
      var dataD   = new Array(rowMax);
      var indexR  = new Array(rowMax);
      var indexA  = new Array(rowMax);
      var indexD  = new Array(rowMax);
      var vlabelR = new Array(rowMax);
      var vlabelA = new Array(rowMax);
      var vlabelD = new Array(rowMax);
 
      // dependent variable
      var dobs, dvarNumber, dvarName, ndvalue;
      var dvar         = new Array(rowMax);
      var dvalueNum    = new Array(rowMax);
      var dataValue    = new Array(rowMax);
      var dvalueLabel  = new Array(rowMax);
      var dvalueFreq   = new Array(rowMax);
      var dataY        = new Array(rowMax);

      // group variable
      var gobs, gvarNumber, gvarName, ngvalue, ngroup;
      var gvar         = new Array(rowMax);
      var gvalueNum    = new Array(rowMax);
      var gdataValue   = new Array(rowMax);
      var gvalueLabel  = new Array(rowMax);
      var gvalueFreq   = new Array(rowMax);
 
      var currentDataSet= new Array(rowMax);
      var currentLabel  = new Array(rowMax);

      // 연속형 그래프 변량 정의
      var tobs;
      var tdata        = new Array(rowMax);
      var tstat        = new Array(20);
      var stat         = new Array(30);
      var xmin, xmax, ymin, ymax, xbuffer, ybuffer;
      var gxmin, gxmax, gxrange, gymin, gymax, gyrange;

      // 그룹 변량 정의
      var ngroupMax  = 50;
      var nobs       = new Array(ngroupMax);
      var dataSet    = new Array(ngroupMax);
      var groupFreq  = new Array(ngroupMax);

      for (k=0; k<ngroupMax; k++) {
          dataSet[k] = new Array(rowMax);
      }  
  
      var nobs   = new Array(ngroupMax);
      var mini   = new Array(ngroupMax);
      var Q1     = new Array(ngroupMax);
      var median = new Array(ngroupMax);
      var Q3     = new Array(ngroupMax);
      var maxi   = new Array(ngroupMax);
      var avg    = new Array(ngroupMax);
      var std    = new Array(ngroupMax);

      // 산점도 변량 정의
      var xobs, xvarNumber, xvarName, yobs, yvarNumber, yvarName;
      var scatterS    = new Array(20);
      var gdata       = new Array(rowMax);
      var gcolor      = new Array(rowMax);
      var xdata       = new Array(rowMax);
      var xvalueLabel = new Array(rowMax);
      var xavg        = new Array(ngroupMax);
      var xstd        = new Array(ngroupMax);
      var ydata       = new Array(rowMax);
      var yvalueLabel = new Array(rowMax);
      var yavg        = new Array(ngroupMax);
      var ystd        = new Array(ngroupMax);
      var alphaR      = new Array(ngroupMax);
      var betaR       = new Array(ngroupMax);
      var corr        = new Array(ngroupMax);
      var rsquare     = new Array(ngroupMax);

      // 히스토그램 변량
      var nint, xstep, freqmax;  
      var gxminH, gxmaxH, gyminH, gymaxH;
      var dataValueH = new Array(rowMax);  // 히스토그램 각 구간값: 최대 구간의 수 =199개
      var freq       = new Array(ngroupMax);
      for (k=0; k<ngroupMax; k++) freq[k] = new Array(rowMax);

      // 가설검정 변량
      var df, info, alpha, pvalue, b, c, d, e, f, g, h;
      var mu, nn, xbar, stdev, vari, variS, teststat, left, right;
      var hypoType, h1Type;
      var df1, df2, t1, t2;
      var nn1,nn2, xbar1, xbar2, var1, var2, varPooled, varAdd;
      var statT = new Array(20);
      var statF = new Array(20);
      var ntot, mtot, ssb, ssw, msb, msw, temp; 

      // 그래프 종류, 체크버튼  블린 변량들
      var VerticalBar, HorizontalBar;
      var SeparateBar, StackBar, RatioBar, SideBar, BothBar;
      var PieChart, DonutGraph, BandGraph, LineGraph, FreqTable;
      var DotGraph, Histogram, BoxGraph, StemLeaf, StemBoth, StatTable, Scatter;
      var THmean1, THmean12, THsigma1, THsigma12, THanova, EditGraph;
      var checkFreq, checkBandFreq, checkMissing, checkData, checkSave;
      var checkDotMean, checkDotStd, checkHistMean, checkHistFreq, checkHistLine;
      var checkRegress;

      buttonColorChange(); // svg 크기, 모든 버튼 체크 초기화
      graphTitle();  // 디폴트 그래프 제목 

// =================================================================
// 시트 컨트롤
// =================================================================
      // sheet 초기화 및 만들기
      var colWidth= [];
      var data    = [ [] ];
      numVar      = 0;
      for (j = 0; j < colMax; j++) colWidth[j] = 50;

      document.getElementById("loadFileName").value = "Untitled.csv";

      container = document.getElementById('datasheet');
      datasheet = new Handsontable(container, {
        data: data,
        minRows: rowMax,
        minCols: colMax,
        minSpareRows: 1,
        colWidths: colWidth,
        colHeaders: rvarName,
        className: "htRight",
        rowHeaders: true,
        rowHeaderWidth: 30,
        contextMenu: true,
        outsideClickDeselects: false,
        multiSelect: true,
        fragmentSelection: false,
      });

      initEventControl(datasheet);

    // 데이터 시트 이벤트 컨트롤 함수  ---------------------------------------------
    function initEventControl(datasheet) {

      // 시트 셀 어느 이벤트 발생하든 cell alignment : 문자 left, 숫자 right
      datasheet.addHook('afterChange', function(change, source){
//        console.log(change.length);
        var row = change[0][0];
        var col = change[0][1];

        if (isNaN(change[0][3])) {
          datasheet.setCellMeta(row,col,"className","htLeft");
        }
        else {
          datasheet.setCellMeta(row,col,"className","htRight");
        }
       
        // update raw data & obs 
        for (j = 0; j < colMax; j++) {
            rvar[j] = datasheet.getDataAtCol(j);
            robs[j] = 0;           
            for (i = 0; i < rowMax; i++) {
              if (rvar[j][i] == null || rvar[j][i] == "" ) { }
              else robs[j]++;
            }  

            // 소수점이하 자리수 체크
            rvarDeci[j] = 0;
            for (i=0; i<robs[j]; i++) {
               m = rvar[j][i].indexOf(".");
               if (m > -1) {
                  k = rvar[j][i].length - (m + 1);
                  if (k > rvarDeci[j]) rvarDeci[j] = k;
               }
	    } // endof i
        }
      
        // 각 변량별 변량값 계산
        numRow = robs[0];
        numCol = 0;
        for (j = 0; j < colMax; j++) {
          if(robs[j] != 0) {
            numCol ++;        
            for (i = 0; i < robs[j]; i++) dataA[i] = rvar[j][i];
            rvalueNum[j] = sortAscend(robs[j], dataA, dataValue, dvalueFreq);
            for (k = 0; k < rvalueNum[j]; k++) rvalue[j][k] = dataValue[k];
          }
        }

        datasheet.render();

        // 선택된 변수 초기화
        document.getElementById("select").value = "";
        numVar = 0;

      });


      // 시트 컬럼 이벤트 컨트롤
      datasheet.addHook('afterOnCellMouseDown', function(event,coords){
//        console.log(coords);
//        console.log(coords.row+" "+coords.col);
        var selected, numOfSelectedColumns;

        if (coords.row == -1) {
          selected    = datasheet.getSelected();
          numOfSelectedColumns =  selected[3] - selected[1] + 1;
          for(j = 0; j < numOfSelectedColumns; j++) {
              k = j + parseInt(selected[1]);
	      tdvarNumber[numVar+j]  = k + 1;
              tdobs[numVar+j]        = robs[k];
              tdvalueNum[numVar+j]   = rvalueNum[k];
	      tdvarName[numVar+j]    = datasheet.getColHeader(j + selected[1]); 
              tdvalue[numVar+j]      = rvalue[k];
              tdvalueLabel[numVar+j] = rvalueLabel[k];       
	      tdvar[numVar+j]        = datasheet.getDataAtCol(j + selected[1]);
	  }

          numVar += numOfSelectedColumns;

          var str = "";
          for (i=0; i<numVar; i++) {
            str += " "+tdvarNumber[i].toString()+",";
          }
          d3.select("#select").node().value = str;

          buttonColorChange(); // svg 크기, 모든 버튼 체크 초기화
        }
      });

    }  // 데이터시트 이벤트 초기화 함수 끝 --------------------------------------------


      // 변량 선택 취소
      d3.select("#debugBtn").on("click",function() {
        variableSelectClear();
      })

      // 변량 선택 초기화 함수
      function variableSelectClear() {
         document.getElementById("select").value = "";
         for(j = 0; j < numVar; j++) {
	    tdvarNumber[j]  = null;
	    tdvarName[j]    = null; 
            for(k = 0; k < rowMax; k++) {
              tdvalueLabel[j][k] = null;       
	      tdvar[j][k]        = null;
            }
	 }
         numVar = 0;
      }

      // 새 시트
      d3.select("#new").on("click",function() {

	  try {
	      datasheet.destroy();
	  } catch (e) {
	      // alert("");
	  }
			   
        numVar  = 0;
        for (j = 0; j < colMax; j++) {
          colWidth[j] = 50;
          rvarName[j]     = "V"+(j+1).toString();
        }
     


        datasheet = new Handsontable(container, {
          minRows: rowMax,
          minCols: colMax,
          minSpareRows: 1,
          colWidths: colWidth,
          colHeaders: rvarName,
          className: "htRight",
          rowHeaders: true,
          rowHeaderWidth: 30,
          contextMenu: true,
          outsideClickDeselects: false,
          multiSelect: true,
          fragmentSelection: false,
        });

         datasheet.selectCell(0,0);   // 커서 위치를 (0,0)으로

         variableSelectClear();
         document.getElementById("loadFileName").value = "Untitled.csv";
         for(j = 0; j < colMax; j++) {
           robs[j]         = 0;
           for (i = 0; i < rowMax; i++) {
             rvar[j][i]        = null;
             rvalue[j][i]      = null;
             rvalueLabel[j][i] = null;
           }
	   tdvarNumber[j]  = null;
	   tdvarName[j]    = null; 
           tdvalueLabel[j] = [];       
	   tdvar[j]        = [];
	 }
         numVar = 0;

         initEventControl(datasheet);

      }) // endof new sheet

      // import CSV file
      d3.select("#icon_importCSV").on("click",function() {
          $("#importCSV").click();
      })


      function importCSV(obj) {
          var fr = new FileReader();
        str = obj.files[0].name;
        document.getElementById("loadFileName").value = str;
        fr.onload = function(e) {
	    data  = d3.csvParse(fr.result);
           datasheet.destroy();

            datasheet = new Handsontable(container, {
             data: data.map(Object.values),
             minRows: rowMax,     // 파일 읽을때는 데이터 개수만큼만 되어야
             minCols: colMax,
	     minSpareRows: 0,
             colWidths: colWidth,
	     colHeaders: data.columns,
	     rowHeaders: true,
             rowHeaderWidth: 30,
	     contextMenu: true,
	     outsideClickDeselects: false,
	     multiSelect: true,
	     fragmentSelection: false,
	   });


           // load된 데이터 문자 숫자 alignment, colWidth 조정
           var colCharMax = [];
           var m, strRead;
           for (j=0; j<datasheet.countCols(); j++) {
             colCharMax[j] = 0;
             rvarDeci[j]   = 0;
             for (i=0; i<datasheet.countRows(); i++) {
               strRead = datasheet.getDataAtCell(i,j);
	       if(strRead == null) continue;
               // count # of char, 영어 1, 한글 2
               k = 0;  
               for (m=0; m<strRead.length; m++) {  
                 if (is_hangul_char(strRead[m])) k = k + 2;
                 else k++;
               }
               if (k > colCharMax[j]) colCharMax[j] = k;

               // 문자 왼쪽정렬, 숫자 오른쪽정렬
               if (isNaN(datasheet.getDataAtCell(i,j)) ) {
                 datasheet.setCellMeta(i,j,"className","htLeft");
               }
               else {
                 datasheet.setCellMeta(i,j,"className","htRight");
               }

               // 소수점이하 자리수 체크
               m = strRead.indexOf(".");
               if (m > -1) {
                  k = strRead.length - (m + 1);
                  if (k > rvarDeci[j]) rvarDeci[j] = k;
               }
         
	     } // endof i

             if (colCharMax[j] < 6) colWidth[j] = 55;
             else colWidth[j] = 5 + colCharMax[j]*8;
           } // endof j
	   datasheet.getSettings().colWidths = colWidth;
           datasheet.render();

           // 새 파일 분석을 위한 초기화
           variableSelectClear();

           // 새 파일 값으로 변량 입력 : To be finished with system file
           for (j = 0; j < colMax; j++) {
             rvar[j]     = datasheet.getDataAtCol(j);
             rvarName[j] = datasheet.getColHeader(j); 
             robs[j] = 0;           
             for (i = 0; i < rowMax; i++) {
               if (rvar[j][i] == null || rvar[j][i] == "" ) { }
               else robs[j]++;
             }  
           }

           // 각 변량별 변량값 계산  To be finished with system file
           numRow = robs[0];
           numCol = 0;
           for (j = 0; j < colMax; j++) {
             if(robs[j] != 0) {
               numCol ++;        
               for (i = 0; i < robs[j]; i++) dataA[i] = rvar[j][i];
               rvalueNum[j] = sortAscend(robs[j], dataA, dataValue, dvalueFreq);
               for (k = 0; k < rvalueNum[j]; k++) {
                 rvalue[j][k] = dataValue[k];
                 rvalueLabel[j][k] = null;      // 시스템 파일 읽으면 정정 요
               }
             }
           }

           // 화면, 버튼, 그래프 제목 초기화 
           buttonColorChange(); // svg 크기, 모든 버튼 체크 초기화
           graphTitle();  // 디폴트 그래프 제목 

           initEventControl(datasheet);

        } // endof fr.onload = function(e)

        fr.readAsText(obj.files[0]);
        $("#importCSV").val("");
      } // endof function importCSV(o) --------------------------------------------

      // open json system file ----------------------------------------------------------------
      d3.select("#open").on("click",function() {
         $("#input_openFile").click();
      })

      function loadFile(obj) {
        var fr = new FileReader();
        str = obj.files[0].name;
        document.getElementById("loadFileName").value = str;

        fr.onload = function(e) {
	    var dataobj  = JSON.parse(fr.result);

           datasheet.destroy();
	

           datasheet = new Handsontable(container, {
	       data: dataobj.data,
	       minRows: rowMax,
	       minCols: colMax,
	     minSpareRows: 1,
             colWidths: colWidth,
	     colHeaders: dataobj.colHeaders,
	     rowHeaders: true,
             rowHeaderWidth: 30,
	     contextMenu: true,
	     outsideClickDeselects: false,
	     multiSelect: true,
	     fragmentSelection: false,
	   });


           // load된 데이터 문자 숫자 alignment, colWidth 조정
           var colCharMax = [];
           var m, strRead;
           for (j=0; j<datasheet.countCols(); j++) {
             colCharMax[j] = 0;
             rvarDeci[j]   = 0;
             for (i=0; i<datasheet.countRows(); i++) {
               strRead = datasheet.getDataAtCell(i,j);
	       if(strRead == null) continue;
               // count # of char, 영어 1, 한글 2
               k = 0;  
               for (m=0; m<strRead.length; m++) {  
                 if (is_hangul_char(strRead[m])) k = k + 2;
                 else k++;
               }
               if (k > colCharMax[j]) colCharMax[j] = k;

               // 문자 왼쪽정렬, 숫자 오른쪽정렬
               if (isNaN(datasheet.getDataAtCell(i,j)) ) {
                 datasheet.setCellMeta(i,j,"className","htLeft");
               }
               else {
                 datasheet.setCellMeta(i,j,"className","htRight");
               }

               // 소수점이하 자리수 체크
               m = strRead.indexOf(".");
               if (m > -1) {
                  k = strRead.length - (m + 1);
                  if (k > rvarDeci[j]) rvarDeci[j] = k;
               }
         
	     } // endof i

             if (colCharMax[j] < 6) colWidth[j] = 55;
             else colWidth[j] = 5 + colCharMax[j]*8;
           } // endof j
	   datasheet.getSettings().colWidths = colWidth;
           datasheet.render();

           // 새 파일 분석을 위한 초기화
           variableSelectClear();

           // 새 파일 값으로 변량 입력 : To be finished with system file
           for (j = 0; j < colMax; j++) {
             rvar[j]     = datasheet.getDataAtCol(j);
           }

           // 화면, 버튼, 그래프 제목 초기화 
           buttonColorChange(); // svg 크기, 모든 버튼 체크 초기화
           graphTitle();  // 디폴트 그래프 제목 

           initEventControl(datasheet);

           // 기타 시스템 변수 불러오기
	   rvarName    = dataobj.rvarName;
	   robs        = dataobj.robs;
	   rvalueNum   = dataobj.rvalueNum;
	   rvalue      = dataobj.rvalue;
	   rvalueLabel = dataobj.rvalueLabel;
           numCol      = dataobj.numCol;
           numRow      = dataobj.numRow;
	    
        }
        fr.readAsText(obj.files[0]);
         $("#input_openFile").val("");
      }
				   

// crop a sheet data with empty cells to a complete rectangular data
function cropData(data) {
    var newdata = [];
    data.forEach(function(row) {
	var i = row.findIndex(function(x) {return x == null || x == '';});
	if(i > 0) { newdata.push(row.slice(0, i)); }
	else if(i == -1) { newdata.push(row); }
    });
    return newdata;
}

			   
    // export datasheet to csv ------------------------------------------
    d3.select("#exportCSV").on("click",function() {
        checkDataSave();
        if (checkSave == false) return;
	
	var croppedData = cropData(datasheet.getData());

	var csvhead = datasheet
	    .getColHeader()
	    .slice(0, croppedData[0].length)
	    .map(function(s) {return "\"" + s + "\"";});
	var csvbody = croppedData.reduce(function(a,b) {return a + "\n" + b;});
	var text =  csvhead + "\n" + csvbody;

	var filename = $("#loadFileName").val().replace(/\.json$/, ".csv");
	$("#loadFileName").val(filename);
	
	var blob = new Blob([text], {type: "text/plain;charset=utf-8"});
	saveAs(blob, filename);
    }) //----------------------------------------------------------------


    // save file ---------------------------------------------------------
    d3.select("#save").on("click",function() {
        checkDataSave();
        if (checkSave == false) return;
	var croppedData = cropData(datasheet.getData());
	var croppedColHeader = datasheet.getColHeader()
	    .slice(0, data[0].length);
	// rvar, rvarName, robs, rvalueNum, rvalue, rvalueLabel

	var dataobj = {
	    data       : croppedData,
	    colHeaders : croppedColHeader,
	    rvarName   : rvarName,
	    robs       : robs,
	    rvalueNum  : rvalueNum,
	    rvalue     : rvalue,
	    rvalueLabel: rvalueLabel,
	    numCol     : numCol,
            numRow     : numRow,
	}
	var jsonstr = JSON.stringify(dataobj);

	var filename = $("#loadFileName").val().replace(/\.csv$/, ".json");
	$("#loadFileName").val(filename);

	var blob = new Blob([jsonstr], {type: "text/plain;charset=utf-8"});
	saveAs(blob, filename);
    }) // ------------------------------------------------------------------

    // Data Save 가능여부 체크				   
    function checkDataSave() {
        checkSave = true;
        for (j = 0; j < numCol; j++) {
          for (i = 0; i< numRow; i++) {
            if( rvar[j][i] == null || rvar[0][i] == "" ) {  
              alert(alertMsg[21][0]);
              checkSave = false;
              return; 
            }
          }
        }
    }

				   
    // From https://milooy.wordpress.com/2017/03/28/javascript-print-page/
    // sheet Print
    d3.select("#printSheet").on("click",function() {
	const html = document.querySelector('html');
//	const printContents = document.querySelector('#datasheet').innerHTML;
	const printContents = dataTable().innerHTML;
        const printDiv = document.createElement('table');
	printDiv.className = 'print-div';
		html.appendChild(printDiv);
	printDiv.innerHTML = printContents;
	document.body.style.display = 'none';
	window.print();
	document.body.style.display = 'block';
	printDiv.style.display = 'none';
    });

    // svg Graph Save
      d3.select("#saveGraph").on("click",function() {
        var svg    = d3.select("#SVG");
        var width  = svgWidth;
        var height = svgHeight;
	var svgString = getSVGString(svg.node());
	svgString2Image( svgString, width, height, 'png', save ); 
	function save( dataBlob, filesize ){
	    saveAs( dataBlob, 'eStatGraph.png' );
	}
    });

    // svg Graph Print
    d3.select("#printGraph").on("click",function() {
	const html = document.querySelector('html');
	const printContents = document.querySelector('#svgArea').innerHTML;
	const printDiv = document.createElement('DIV');
	printDiv.className = 'print-div';
		html.appendChild(printDiv);
	printDiv.innerHTML = printContents;
	document.body.style.display = 'none';
	window.print();
	document.body.style.display = 'block';
	printDiv.style.display = 'none';	
    });

    // svg Graph Move
    d3.select("#moveGraph").on("click",function() {
        var svg    = d3.select("#SVG");
        var width  = svgWidth;
        var height = svgHeight;
        var txt    = "<br><p>";
        var svgString = getSVGString(svg.node());
        $("#loc").append(svgString);
        $("#loc").append(txt,txt);
// var imgsrc = 'data:image/svg+xml;utf8,'+svgString;
//        $("#screenTable").append(svgString);
//      $("<img>").attr("src", imgsrc)
//			     .attr("width", width)
//			     .attr("height", height));
    });

    // save Table
    d3.select("#saveTable").on("click", function() {
        saveAs(new Blob([d3.select("#screenTable").html()]), "eStatLog.html");

    });

    // print Table
    d3.select("#printTable").on("click",function() {
	const html = document.querySelector('html');
	const printContents = document.querySelector('#screenTable').innerHTML;
	const printDiv = document.createElement('DIV');
	printDiv.className = 'print-div';
		html.appendChild(printDiv);
	printDiv.innerHTML = printContents;
	document.body.style.display = 'none';
	window.print();
	document.body.style.display = 'block';
	printDiv.style.display = 'none';	
    });

// =================================================================
// 버튼, 라디오버튼, 체크박스 클릭
// =================================================================

      // 학습수준 버튼
      var rad1 = document.myForm1.type1;
      rad1[0].onclick = function() { // 초등
         document.getElementById("screenTopMiddle2").style.display = "none";  // 연속형 그래프 감추기
         document.getElementById("bothstem2").style.display        = "none";  // 양쪽형 줄기잎 감추기
         document.getElementById("statTable").style.display        = "none";  // 기초통계량 감추기
         document.getElementById("estatE").style.display           = "block"; // 예제 보이기
         document.getElementById("estatU").style.display           = "none";  // 대학 모듈 감추기
         document.getElementById("screenTopRight1").style.display  = "none";  // 가설검정 감추기
         document.getElementById("estat").style.display            = "block"; // 예제학습 보이기
      }
      rad1[1].onclick = function() { // 중등
         document.getElementById("screenTopMiddle2").style.display = "block"; // 연속형 그래프
         document.getElementById("bothstem2").style.display        = "block"; // 양쪽형 줄기
         document.getElementById("statTable").style.display        = "block"; // 기초통계량 
         document.getElementById("screenTopRight1").style.display  = "none";  // 가설검정 감추기
         document.getElementById("estatE").style.display           = "block"; // 예제 보이기
         document.getElementById("estatU").style.display           = "none";  // 대학 모듈 감추기
         document.getElementById("estat").style.display            = "block"; // 예제학습 보이기
      }
      rad1[2].onclick = function() { // 대학
         document.getElementById("screenTopMiddle2").style.display = "block"; // 연속형 그래프
         document.getElementById("bothstem2").style.display        = "block"; // 양쪽형 줄기
         document.getElementById("statTable").style.display        = "block"; // 기초통계량 
         document.getElementById("screenTopRight1").style.display  = "block"; // 가설검정 
         document.getElementById("estatE").style.display           = "block"; // 예제 보이기
         document.getElementById("estatU").style.display           = "block"; // 대학 모듈 
         document.getElementById("estat").style.display            = "block"; // 예제학습 보이기
      }

      // 분리형 막대그래프 : 주메뉴
      d3.select("#separate1").on("click",function() {
         graphNum = 1;
         dataClassify();
         if (freqMin < 0) {
           alert(alertMsg[22][langNum]); 
           return;
         };
         if (checkData == false || checkVarSelect == false || checkNumeric == false || checkMissing == true) return;

         buttonColorChange();
         SeparateBar   = true;
         VerticalBar   = true;
         HorizontalBar = false;
         document.getElementById("separate1").style.backgroundColor = buttonColorH;
   
         chart.selectAll("*").remove();
         if (ngroup == 1) currentDataSet = dataSet[0];
         currentLabel = dvalueLabel;

         drawSeparateBarGraph(ngroup, gvarNumber, gvarName, gvalueLabel, ndvalue, dvarNumber, dvarName, dvalueLabel, 
            freqMax, currentLabel, currentDataSet, dataSet, checkFreq);
         document.getElementById("sub1").style.display = "block";       //분리형 막대 도수표시
         if (ngroup == 1) {
           document.getElementById("sub2").style.display = "block";  //분리형 막대 정렬 표시
           document.myForm2.type2.value = 1;
         }
      })

      // 분리형 수직 막대그래프 : 부메뉴
      d3.select("#separate2V").on("click",function() {
         graphNum = 1;
         dataClassify();
         if (freqMin < 0 && SeparateBar) {
           alert(alertMsg[22][langNum]); 
           return;
         };
         if (checkData == false || checkVarSelect == false || checkNumeric == false || checkMissing == true) return;

         buttonColorChange();
         SeparateBar   = true;
         VerticalBar   = true;
         HorizontalBar = false;
         document.getElementById("separate2V").style.backgroundColor = buttonColorH;
   
         chart.selectAll("*").remove();
         if (ngroup == 1) currentDataSet = dataSet[0];
         currentLabel = dvalueLabel;

         drawSeparateBarGraph(ngroup, gvarNumber, gvarName, gvalueLabel, ndvalue, dvarNumber, dvarName, dvalueLabel, 
            freqMax, currentLabel, currentDataSet, dataSet, checkFreq);
         document.getElementById("sub1").style.display = "block";  //분리형 막대 도수표시
         if (ngroup == 1) {
           document.getElementById("sub2").style.display = "block";  //분리형 막대 정렬 표시
           document.myForm2.type2.value = 1;
         }
      })

      // 분리형 수평 막대그래프 : 부메뉴
      d3.select("#separate2H").on("click",function() {
         graphNum = 6;
         dataClassify();
         if (freqMin < 0 && HorizontalBar) {
           alert(alertMsg[23][langNum]); 
           return;
         };
         if (checkData == false || checkVarSelect == false || checkNumeric == false || checkMissing == true) return;

         buttonColorChange();
         SeparateBar   = true;
         VerticalBar   = false; 
         HorizontalBar = true;
         document.getElementById("separate2H").style.backgroundColor = buttonColorH;
   
         chart.selectAll("*").remove();
         if (ngroup == 1) currentDataSet = dataSet[0];
         currentLabel = dvalueLabel;

         drawSeparateBarGraph(ngroup, gvarNumber, gvarName, gvalueLabel, ndvalue, dvarNumber, dvarName, dvalueLabel, 
            freqMax, currentLabel, currentDataSet, dataSet, checkFreq);
         if (ngroup == 1) {
           document.getElementById("sub2").style.display = "block";  //분리형 막대 정렬 표시
           document.myForm2.type2.value = 1;
         }
      })

      // 막대그래프 도수표시 버튼 클릭
      d3.select("#freq").on("click",function() {
        if (SeparateBar) {
          if(this.checked) {
            checkFreq = true;
            drawSeparateBarGraph(ngroup, gvarNumber, gvarName, gvalueLabel, ndvalue, dvarNumber, dvarName, dvalueLabel, 
              freqMax, currentLabel, currentDataSet, dataSet, checkFreq);
          } else {
            checkFreq = false;
	    removeFreq();
          }
        }
      })

      // 그룹이 없을 경우 막대그래프 내림차순, 올림차순 버튼
      var rad2 = document.myForm2.type2;
      rad2[0].onclick = function() { // 원자료
        if (SeparateBar && ngroup == 1) {
          chart.selectAll("*").remove();
          currentDataSet = dataR;
          currentLabel   = vlabelR; 
          drawSeparateBarGraph(ngroup, gvarNumber, gvarName, gvalueLabel, ndvalue, dvarNumber, dvarName, dvalueLabel, 
            freqMax, currentLabel, currentDataSet, dataSet, checkFreq);
        }          
      }
      rad2[1].onclick = function() { // 내림차순
        if (SeparateBar && ngroup == 1) {
          chart.selectAll("*").remove();
          currentDataSet = dataD;
          currentLabel   = vlabelD;
          drawSeparateBarGraph(ngroup, gvarNumber, gvarName, gvalueLabel, ndvalue, dvarNumber, dvarName, dvalueLabel, 
            freqMax, currentLabel, currentDataSet, dataSet, checkFreq);
        }         
      }
      rad2[2].onclick = function() { // 올림차순
         if (SeparateBar && ngroup == 1) {
          chart.selectAll("*").remove();
          currentDataSet = dataA;
          currentLabel   = vlabelA;
          drawSeparateBarGraph(ngroup, gvarNumber, gvarName, gvalueLabel, ndvalue, dvarNumber, dvarName, dvalueLabel, 
            freqMax, currentLabel, currentDataSet, dataSet, checkFreq);
        }        
      }

      // 쌓는형 수직 막대 버튼 클릭
      d3.select("#stack2V").on("click",function() {
         graphNum = 2;
         dataClassify();
         if (freqMin < 0 ) {
           alert(alertMsg[24][langNum]); 
           return;
         };
         if (ngroup == 1) {
           alert(alertMsg[25][langNum]); 
           return;
         };
         if (checkData == false || checkVarSelect == false || checkNumeric == false || checkMissing == true) return;

         buttonColorChange();
         StackBar      = true
         VerticalBar   = true;
         HorizontalBar = false;
         document.getElementById("stack2V").style.backgroundColor    = buttonColorH;
 
         chart.selectAll("*").remove();
         drawStackBar(ngroup, gvarNumber, gvarName, gvalueLabel, ndvalue, dvarNumber, dvarName, dvalueLabel, freqMax, dataSet);
      })

      // 쌓는형 수평 막대 버튼 클릭
      d3.select("#stack2H").on("click",function() {
         graphNum = 7;
         dataClassify();
         if (freqMin < 0 ) {
           alert(alertMsg[24][langNum]); 
           return;
         };
         if (ngroup == 1) {
           alert(alertMsg[25][langNum]); 
           return;
         };
         if (checkData == false || checkVarSelect == false || checkNumeric == false || checkMissing == true) return;

         buttonColorChange();
         StackBar      = true;
         VerticalBar   = false; 
         HorizontalBar = true;
         document.getElementById("stack2H").style.backgroundColor    = buttonColorH;
 
         chart.selectAll("*").remove();
         drawStackBar(ngroup, gvarNumber, gvarName, gvalueLabel, ndvalue, dvarNumber, dvarName, dvalueLabel, freqMax, dataSet);
      })

      // 비율형 수직 막대 버튼 클릭
      d3.select("#ratio2V").on("click",function() {
         graphNum = 3;
         dataClassify();
         if (freqMin < 0 ) {
           alert(alertMsg[26][langNum]); 
           return;
         };
         if (ngroup == 1) {
           alert(alertMsg[27][langNum]); 
           return;
         };
         if (checkData == false || checkVarSelect == false || checkNumeric == false || checkMissing == true) return;

         buttonColorChange();
         RatioBar      = true;
         VerticalBar   = true;
         HorizontalBar = false;
         document.getElementById("ratio2V").style.backgroundColor    = buttonColorH;
 
         chart.selectAll("*").remove();
         drawRatioBarGraph(ngroup, gvarNumber, gvarName, gvalueLabel, ndvalue, dvarNumber, dvarName, dvalueLabel, freqMax, dataSet);
      })

      // 비율형 수평 막대 버튼 클릭
      d3.select("#ratio2H").on("click",function() {
         graphNum = 8;
         dataClassify();
         if (freqMin < 0 ) {
           alert(alertMsg[26][langNum]); 
           return;
         };
         if (ngroup == 1) {
           alert(alertMsg[27][langNum]); 
           return;
         };
         if (checkData == false || checkVarSelect == false || checkNumeric == false || checkMissing == true) return;

         buttonColorChange();
         RatioBar      = true;
         VerticalBar   = false; 
         HorizontalBar = true;
         document.getElementById("ratio2H").style.backgroundColor    = buttonColorH;
 
         chart.selectAll("*").remove();
         drawRatioBarGraph(ngroup, gvarNumber, gvarName, gvalueLabel, ndvalue, dvarNumber, dvarName, dvalueLabel, freqMax, dataSet);
      })

      // 나란형 수직 막대그래프
      d3.select("#side2V").on("click",function() {
         graphNum = 4;
         dataClassify();
         if (freqMin < 0 ) {
           alert(alertMsg[28][langNum]); 
           return;
         };
         if (ngroup == 1) {
           alert(alertMsg[29][langNum]); 
           return;
         };
         if (checkData == false || checkVarSelect == false || checkNumeric == false || checkMissing == true) return;

         buttonColorChange();
         SideBar       = true;
         VerticalBar   = true;
         HorizontalBar = false;
         document.getElementById("side2V").style.backgroundColor     = buttonColorH;
 
         chart.selectAll("*").remove();
         drawSideBarGraph(ngroup, gvarNumber, gvarName, gvalueLabel, ndvalue, dvarNumber, dvarName, dvalueLabel, freqMax, dataSet);
      })

      // 나란형 수평 막대그래프
      d3.select("#side2H").on("click",function() {
         graphNum = 9;
         dataClassify();
         if (freqMin < 0 ) {
           alert(alertMsg[28][langNum]); 
           return;
         };
         if (ngroup == 1) {
           alert(alertMsg[29][langNum]); 
           return;
         };
         if (checkData == false || checkVarSelect == false || checkNumeric == false || checkMissing == true) return;

         buttonColorChange();
         SideBar       = true;
         VerticalBar   = false; 
         HorizontalBar = true;
         document.getElementById("side2H").style.backgroundColor     = buttonColorH;
 
         chart.selectAll("*").remove();
         drawSideBarGraph(ngroup, gvarNumber, gvarName, gvalueLabel, ndvalue, dvarNumber, dvarName, dvalueLabel, freqMax, dataSet);
      })

      // 양쪽형 수직 막대 버튼 클릭
      d3.select("#bothbar2V").on("click",function() {
         graphNum = 5;
         dataClassify();
         if (freqMin < 0 ) {
           alert(alertMsg[30][langNum]); 
           return;
         };
         if (ngroup == 1) {
           alert(alertMsg[31][langNum]); 
           return;
         };

         if (ngroup == 2) {
           if (checkData == false || checkVarSelect == false || checkNumeric == false || checkMissing == true) return;
           buttonColorChange();
           BothBar       = true;
           VerticalBar   = true;
           HorizontalBar = false;
           document.getElementById("bothbar2V").style.backgroundColor     = buttonColorH;
  
           chart.selectAll("*").remove();
           drawBothBar(ngroup, gvarNumber, gvarName, gvalueLabel, ndvalue, dvarNumber, dvarName, dvalueLabel, freqMax, dataSet);
         }
      })

      // 양쪽형 수평 막대 버튼 클릭
      d3.select("#bothbar2H").on("click",function() {
         graphNum = 10;
         dataClassify();
         if (freqMin < 0 ) {
           alert(alertMsg[30][langNum]); 
           return;
         };
         if (ngroup == 1) {
           alert(alertMsg[31][langNum]); 
           return;
         };
         if (ngroup == 2) {
           if (checkData == false || checkVarSelect == false || checkNumeric == false || checkMissing == true) return;
           buttonColorChange();
           BothBar       = true;
           VerticalBar   = false; 
           HorizontalBar = true;
           document.getElementById("bothbar2H").style.backgroundColor     = buttonColorH;
  
           chart.selectAll("*").remove();
           drawBothBar(ngroup, gvarNumber, gvarName, gvalueLabel, ndvalue, dvarNumber, dvarName, dvalueLabel, freqMax, dataSet);
         }
      })

      // 원그래프 버튼 클릭 : 주메뉴
      d3.select("#pie1").on("click",function() {
         graphNum = 11;
         dataClassify();
         if (freqMin < 0 ) {
           alert(alertMsg[32][langNum]); 
           return;
         };
         if (checkData == false || checkVarSelect == false || checkNumeric == false || checkMissing == true) return;

         buttonColorChange();
         PieChart    = true;
         document.getElementById("pie1").style.backgroundColor      = buttonColorH;

         chart.selectAll("*").remove();
 	 drawPieChart(ngroup, gvarNumber, gvarName, gvalueLabel, ndvalue, dvarNumber, dvarName, dvalueLabel, freqMax, dataSet);  
      })

      // 도넛그래프 버튼 클릭
      d3.select("#donut2").on("click",function() {
         graphNum = 12;
         dataClassify();
         if (freqMin < 0 ) {
           alert(alertMsg[33][langNum]); 
           return;
         };
         if (checkData == false || checkVarSelect == false || checkNumeric == false || checkMissing == true) return;

         document.getElementById("mean").checked = false;
         buttonColorChange();
         DonutGraph  = true;
         document.getElementById("donut2").style.backgroundColor      = buttonColorH;

         chart.selectAll("*").remove();
         drawPieChart(ngroup, gvarNumber, gvarName, gvalueLabel, ndvalue, dvarNumber, dvarName, dvalueLabel, freqMax, dataSet) ;
      })

      // 띠그래프 버튼 클릭 : 주메뉴
      d3.select("#band1").on("click",function() {
         graphNum = 13;
         dataClassify();
         if (freqMin < 0 ) {
           alert(alertMsg[34][langNum]); 
           return;
         };
         if (checkData == false || checkVarSelect == false || checkNumeric == false || checkMissing == true) return;

         document.getElementById("mean").checked = false;
         buttonColorChange();
         BandGraph   = true;
         document.getElementById("band1").style.backgroundColor     = buttonColorH;

         chart.selectAll("*").remove();
         drawBandGraph(ngroup, gvarNumber, gvarName, gvalueLabel, ndvalue, dvarNumber, dvarName, dvalueLabel, freqMax, dataSet);
         document.getElementById("sub3").style.display = "block";  //띠그래프 도수표시
      })


     // 띠그래프 도수표시 버튼 클릭
      d3.select("#mean").on("click",function() {
        if (!BandGraph) return;
        if(this.checked) {
          if (BandGraph) {
            checkBandFreq = true;
            chart.selectAll("*").remove();
            drawBandGraph(ngroup, gvarNumber, gvarName, gvalueLabel, ndvalue, dvarNumber, dvarName, dvalueLabel, freqMax, dataSet);
          }
        } else {
            checkBandFreq = false;
	    removeBandFreq();
          }
      })

      // 꺽은선그래프 클릭 : 주메뉴
      d3.select("#line1").on("click",function() {
         graphNum = 14;
         dataClassify();
         if (checkData == false || checkVarSelect == false || checkNumeric == false || checkMissing == true) return;

         buttonColorChange();
         LineGraph   = true;
         document.getElementById("line1").style.backgroundColor     = buttonColorH;
 
         chart.selectAll("*").remove();
         currentLabel = dvalueLabel;
         drawLineGraph(ngroup, gvarNumber, gvarName, gvalueLabel, ndvalue, dvarNumber, dvarName, dvalueLabel, freqMin, freqMax, currentLabel, currentDataSet, dataSet);
         if (ngroup == 1) {
           document.getElementById("sub4").style.display = "block";  //꺽은선그래프 정렬 표시
           document.myForm3.type3.value = 1;
         }
      })

      // 그룹이 없을 경우 꺽은선그래프 내림차순, 올림차순 버튼
      var rad3 = document.myForm3.type3;
      rad3[0].onclick = function() { // 원자료
       if (LineGraph && ngroup == 1) {
          chart.selectAll("*").remove();
          currentDataSet = dataR;
          currentLabel = vlabelR;
          drawLineGraph(ngroup, gvarNumber, gvarName, gvalueLabel, ndvalue, dvarNumber, dvarName, dvalueLabel, freqMin, freqMax, currentLabel, currentDataSet, dataSet);
       }      
      }
      rad3[1].onclick = function() { // 내림차순
        if (LineGraph && ngroup == 1) {
          chart.selectAll("*").remove();
          currentDataSet = dataD;
          currentLabel = vlabelD;
          drawLineGraph(ngroup, gvarNumber, gvarName, gvalueLabel, ndvalue, dvarNumber, dvarName, dvalueLabel, freqMin, freqMax, currentLabel, currentDataSet, dataSet);
        }      
      }
      rad3[2].onclick = function() { // 올림차순
        if (LineGraph && ngroup == 1) {
          chart.selectAll("*").remove();
          currentDataSet = dataA;
          currentLabel = vlabelA;
          drawLineGraph(ngroup, gvarNumber, gvarName, gvalueLabel, ndvalue, dvarNumber, dvarName, dvalueLabel, freqMin, freqMax, currentLabel, currentDataSet, dataSet);
        }
      }

      // 도수분포표 버튼 클릭
      d3.select("#freqTable").on("click",function() {
         dataClassify();
         if (freqMin < 0) {
           alert(alertMsg[35][langNum]); 
           return;
         };
         if (checkData == false || checkVarSelect == false || checkNumeric == false || checkMissing == true) return;

         document.getElementById("mean").checked = false;
         buttonColorChange();
         FreqTable   = true;
         document.getElementById("freqTable").style.backgroundColor     = buttonColorH;

         ngvalue = ngroup;
         freqTable(numVar, tdvarNumber, ndvalue, dvarName, dataValue, dvalueLabel, ngroup, gvarName, gvalueLabel);
      })

      // ==========================================================================================
      // 연속형 변량 그래프 ========================================================================
      //===========================================================================================
      // 그룹 점그래프 : 주메뉴 
      d3.select("#dot1").on("click",function() {
        graphNum = 15;
        dataClassifyM();
        if (checkData == false || checkVarSelect == false || checkNumeric == false || checkMissing == true) return;

        buttonColorChange();
        DotGraph  = true;
        document.getElementById("dot1").style.backgroundColor = buttonColorH;
        TotalStat(dobs, dvar, tstat);       
        GroupStat(ngroup, nobs, dataSet, mini, Q1, median, Q3, maxi, avg, std);

        chart.selectAll("*").remove();
        drawDotGraph(ngroup, gvalueLabel, nobs, graphWidth, graphHeight, buffer, tstat, dvarName);
        document.getElementById("sub5").style.display = "block";  //점그래프 평균, 표준편차표시
      })    
  
      // 점그래프 평균 표시
      d3.select("#DotMean").on("click",function() {
        if(DotGraph) {
          if(this.checked) {
            checkDotMean = true;
            gxmin = tstat[11];
            gxmax = tstat[12];
            showDotMean(ngroup, avg, gxmin, gxmax, tstat[13], tstat[14]);
          } else {
            checkDotMean = false;
	    removeDotMean();
          }
        }
      })

      // 점그래프 표준편차 표시
      d3.select("#DotStd").on("click",function() {
        if(DotGraph) {
          if(this.checked) {
            checkDotStd = true;
            gxmin = tstat[11];
            gxmax = tstat[12];
            showDotStd(avg, std, gxmin, gxmax, tstat[13], tstat[14]);
          } else {
            checkDotStd = false;
            removeDotStd();
          }
        }
      })

      // 히스토그램 주메뉴 -----------------------------------------------------------------------------------------
      d3.select("#hist1").on("click",function() {
        graphNum = 19;
        dataClassifyM();
        if (checkData == false || checkVarSelect == false || checkNumeric == false || checkMissing == true) return;

        buttonColorChange();
        Histogram = true;
        document.getElementById("hist1").style.backgroundColor = buttonColorH;
        TotalStat(dobs, dvar, tstat);       
        GroupStat(ngroup, nobs, dataSet, mini, Q1, median, Q3, maxi, avg, std);

        chart.selectAll("*").remove();
        nint  = 7;
        xstep = (tstat[7] - tstat[3]) / nint; // (전체 최대 - 최소) / 인터발수  : 양쪽 그래프 buffer 
        gxminH = tstat[3] - xstep;
        var para = drawHistGraph(ngroup, gxminH, xstep, dataSet, freq, gvalueLabel, dvalueLabel, dvarName);
        gxmaxH = para.a;
        gyminH = para.b;
        gymaxH = para.c;
        document.getElementById("sub7").style.display = "block";  //히스토그램 선택사항 표시
      })

     // 히스토그램 평균표시
      d3.select("#HistMean").on("click",function() {
        if (Histogram == false) return;
        if(this.checked) {
            checkHistMean = true;
            showHistMean(ngroup, avg, gxminH, gxmaxH);
        } 
          else {
            checkHistMean = false;
            removeHistMean();
        }
      })
    
      // 히스토그램 도수표시
      d3.select("#HistFreq").on("click",function() {
        if (Histogram == false) return;
        if(this.checked) {
          checkHistFreq = true;
          showHistFreq(ngroup, nvalueH, xstep, freq, dataValueH, gxminH, gxmaxH, gyminH, gymaxH);
        }
        else { 
          checkHistFreq = false;
          removeHistFreq();
        }
      })

      // 히스토그램 꺽은선그래프 표시 
      d3.select("#HistLine").on("click",function() {
        if (Histogram == false) return;
        if(this.checked) {
          checkHistLine = true;
          showHistLine(ngroup, nvalueH, xstep, freq, dataValueH, gxminH, gxmaxH, gyminH, gymaxH);
        }
        else { 
          checkHistLine = false;
          removeHistLine()
        }      
      })

      // 히스토그램 도수분포표 표시 
      d3.select("#histTable").on("click",function() {;
        if (Histogram == false) return;
          showHistTable(ngroup, nvalueH, freq, dataValueH, dvarName, gvarName,gvalueLabel)
      })

      // 새 구간으로 히스토그램 업데이트
      d3.select("#HistRedraw").on("click", function(){ 
        if (Histogram == false) return; 
        chart.selectAll("*").remove();  // 전화면 제거

	var start = parseFloat(d3.select("#HistInit").node().value);  // 시작값 
        xstep = parseFloat(d3.select("#HistStep").node().value);      // 구간너비 
        if (start > tstat[3]) start = tstat[3];
        if (xstep <= 0) xstep = (tstat[7] - tstat[3]) / nint;
        gxminH = start - xstep;
        var para = drawHistGraph(ngroup, gxminH, xstep, dataSet, freq, gvalueLabel, dvalueLabel, dvarName);
        gxmaxH = para.a;
        gyminH = para.b;
        gymaxH = para.c;

        if(checkHistMean) showHistMean(ngroup, avg, gxminH, gxmaxH);   // 평균 표시
        if(checkHistFreq) showHistFreq(ngroup, nvalueH, xstep, freq, dataValueH, gxminH, gxmaxH, gyminH, gymaxH); // 도수 표시
        if(checkHistLine) showHistLine(ngroup, nvalueH, xstep, freq, dataValueH, gxminH, gxmaxH, gyminH, gymaxH); // 꺽은선 표시
 
      })

      // 상자그래프 : 주메뉴 -----------------------------------------------------------------------------------------
      d3.select("#box1").on("click",function() {
        graphNum = 16;
        dataClassifyM();
        if (checkData == false || checkVarSelect == false || checkNumeric == false || checkMissing == true) return;

        buttonColorChange();
        BoxGraph  = true;
        document.getElementById("box1").style.backgroundColor = buttonColorH;
        TotalStat(dobs, dvar, tstat);       
        GroupStat(ngroup, nobs, dataSet, mini, Q1, median, Q3, maxi, avg, std);

        chart.selectAll("*").remove();
//        chart.append("text").attr("class","title").attr("x",margin.left).attr("y",margin.top/2).text(title);
        drawBoxGraph(ngroup, gvalueLabel, mini, Q1, median, Q3, maxi, graphWidth, oneHeight, tstat);
      })

      // 줄기잎그래프 : 주메뉴 -----------------------------------------------------------------------------------------
      d3.select("#stem1").on("click",function() {
        graphNum = 17;
        dataClassifyM();
        if (checkData == false || checkVarSelect == false || checkNumeric == false || checkMissing == true) return;

        buttonColorChange();
        StemLeaf  = true;
        document.getElementById("stem1").style.backgroundColor = buttonColorH;
        TotalStat(dobs, dvar, tstat);       
        GroupStat(ngroup, nobs, dataSet, mini, Q1, median, Q3, maxi, avg, std);

        chart.selectAll("*").remove();
        drawStemLeaf(ngroup, nobs, dataSet, tstat, graphWidth, buffer);
      })

      // 양쪽형 줄기와 잎 그림 버튼 클릭
      d3.select("#bothstem2").on("click",function() { 
        graphNum = 18;
        dataClassifyM();
        if (ngroup != 2) {
          alert(alertMsg[36][langNum]); 
          return;
        }
        if (checkData == false || checkVarSelect == false || checkNumeric == false || checkMissing == true) return;

        buttonColorChange();
        StemBoth  = true;
        document.getElementById("bothstem2").style.backgroundColor = buttonColorH;
        TotalStat(dobs, dvar, tstat);       
        GroupStat(ngroup, nobs, dataSet, mini, Q1, median, Q3, maxi, avg, std);

        chart.selectAll("*").remove();
        drawStemLeafBoth(ngroup, nobs, dataSet, tstat, graphWidth, buffer);
      })

      // 기초통계량 버튼 클릭 -------------------------------------------------------------------------------
      d3.select("#statTable").on("click",function() {  

        dataClassifyM();
        if (rawData == false) return;
        if (checkData == false || checkVarSelect == false || checkNumeric == false || checkMissing == true) return;

        buttonColorChange();
        StatTable = true;
        document.getElementById("statTable").style.backgroundColor = buttonColorH;
        TotalStat(dobs, dvar, tstat);       
        GroupStat(ngroup, nobs, dataSet, mini, Q1, median, Q3, maxi, avg, std);
    
        statTable(ngroup, dvarName, gvarName, gvalueLabel, nobs, avg, std, mini, Q1, median, Q3, maxi,tstat);
      })

      // 산점도 버튼 클릭 -------------------------------------------------------------------------------
      d3.select("#scatter1").on("click",function() {  
        graphNum = 20;
        dataClassifyS();
        if (checkData == false || checkVarSelect == false || checkNumeric == false || checkMissing == true) return;

        buttonColorChange();
        Scatter = true;
        document.getElementById("scatter1").style.backgroundColor = buttonColorH;    

        tobs = xobs;
        SortAscendBasic(tobs, gdata, dataA);        // Sorting data in ascending order 
        ngroup  = DotValueFreq(tobs, dataA, gdataValue, gvalueFreq ) 
        bivarStatByGroup(ngroup,tobs,xdata,ydata,gdata,nobs,xavg,yavg,xstd,ystd,alphaR,betaR,corr,rsquare) 

        drawScatter(ngroup,gvalueLabel,tobs,xdata,ydata,gdata,scatterS);
        document.getElementById("sub6").style.display = "block";  //회귀선 표시

     })

      // 산점도 회귀선 그리기
      d3.select("#regress").on("click",function() {
          if(Scatter == false) return;
          if(this.checked) {
            checkRegress = true;
            showRegression(ngroup, alphaR, betaR, corr, rsquare, scatterS);
          } 
          else {
            checkRegress = false;
	    removeRegression();
          }
      })




      // eStatH 메뉴
      d3.select("#estatH").on("click",function() {
        window.open("../eStatH/index_en.html");
      })

      // eStatU 메뉴
      d3.select("#estatU").on("click",function() {
        window.open("../eStatU/index_en.html");
      })

      // eStatE 메뉴
      d3.select("#estatE").on("click",function() {
        window.open("../eStatE/index_en.html");
      })

      // eStat 메뉴
      d3.select("#estat").on("click",function() {
        window.open("../ExLearning");
      })

      // language Button
      d3.select("#langBtn").on("click",function() {
        window.open("index.html","_self");
      })

      // Example Download Button
      d3.select("#downBtn").on("click",function() {
        // to be done

      })




      // 모평균 가설검정
      d3.select("#testM1").on("click",function() {
        graphNum = 21;
        if (numVar > 1) {
          alert(alertMsg[37][langNum]); 
          return;
        };
        dataClassifyM();
        if (checkData == false || checkVarSelect == false || checkNumeric == false || checkMissing == true) return;

        buttonColorChange();
        THmean1 = true;
        document.getElementById("testM1").style.backgroundColor = buttonColorH;
        TotalStat(dobs, dvar, tstat);       

        chart.selectAll("*").remove();
        document.getElementById("sub8").style.display = "block";  //가설검정 선택사항표시

        hypoType = 1;
        h1Type   = 1;
        testType = 2;
        alpha    = 0.05;
        h        = alpha / 2;  
        nn       = tstat[0];
        df       = nn - 1;
        mu       = tstat[1];
        xbar     = tstat[1];
        stdev    = tstat[2]; 
        teststat = (xbar - mu) / (stdev / Math.sqrt(nn));
        temp = t_inv(1 - alpha/2, df, info) * stdev / Math.sqrt(nn);
        left  = xbar - temp;
        right = xbar + temp;  

        f = t_inv(h, df, info);
        g = -f;
        if (teststat < 0) pvalue = 2 * t_cdf(teststat, df, info);
        else  pvalue = 2 * (1 - t_cdf(teststat, df, info));
       
        statT[0] = xbar;    // 초기 mu
        statT[1] = stdev;   // Z test 경우 sigma
        statT[2] = alpha;
        statT[3] = nn;
        statT[4] = xbar;
        statT[5] = stdev;
        statT[6] = left;
        statT[7] = right;

        drawTdistGraphTH(hypoType, h1Type, testType, statT, teststat, df, f, g, h, pvalue);
      })

      // 모평균 가설검정 재실행
        // H1 type
        var h8 = document.myForm80.type0;
        h8[0].onclick = function() { h1Type = 1; }    // 양측검정
        h8[1].onclick = function() { h1Type = 2; }    // 우측검정
        h8[2].onclick = function() { h1Type = 3; }    // 좌측검정

        // Test type
        var test8 = document.myForm81.type1;
        test8[0].onclick = function() { testType = 2; }  // Z-test
        test8[1].onclick = function() { testType = 1; }  // t-test
 
        // alpha
        var a8 = document.myForm82.type2;
        a8[0].onclick = function() { alpha = 0.05; }  
        a8[1].onclick = function() { alpha = 0.01; }  

      d3.select("#executeTH8").on("click",function() {
        graphNum = 21;
        // input value
        mu    = parseFloat(d3.select("#mu8").node().value);
        if (isNaN(mu)) {
            alert(alertMsg[38][langNum]); 
            return;
        }

        nn    = tstat[0];
        df    = nn - 1;
        xbar  = tstat[1];
        stdev = tstat[2];
        if (testType == 1) {
          stdev= parseFloat(d3.select("#std8").node().value);
          if (stdev == 0. || isNaN(stdev) ) {
            alert(alertMsg[39][langNum]); 
            return;
          }
        }

        // confidence interval
        if (testType == 1) temp = stdnormal_inv(1 - alpha/2, info) * stdev / Math.sqrt(nn);
        else temp = t_inv(1 - alpha/2, df, info) * stdev / Math.sqrt(nn);
        left  = xbar - temp;
        right = xbar + temp;  

        // test statistics
        teststat = (xbar - mu) / (stdev / Math.sqrt(nn));

        statT[0] = mu;      // 초기 mu
        statT[1] = stdev;   // Z test 경우 sigma
        statT[2] = alpha;
        statT[3] = nn;
        statT[4] = xbar;
        statT[5] = tstat[2];
        statT[6] = left;
        statT[7] = right;

        chart.selectAll("*").remove();

        if (isNaN(mu) || isNaN(nn) || isNaN(xbar) || isNaN(stdev) || nn < 2 || stdev <= 0 ) {  // wrong input
          chart.append("text").attr("class","mean")
             .attr("x", 150)
             .attr("y", 100)
             .text("No input or wrong input !!   Try again.")
             .style("stroke","red")
        }
        else if (testType == 1) {    // Z-test
          if (h1Type == 1) {
            h = alpha / 2;  
            f = stdnormal_inv(h, info);
            g = -f;
            if (teststat < 0) pvalue = 2 * stdnormal_cdf(teststat);
            else  pvalue = 2 * (1 - stdnormal_cdf(teststat));
            drawNormalGraphTH(hypoType, h1Type, testType, statT, teststat, 0, 1, f, g, h, pvalue);
          }
          else if (h1Type == 2) {
            h = alpha;  
            f = -5
            g = stdnormal_inv(1-h, info);
            pvalue = 1 - stdnormal_cdf(teststat);
            drawNormalGraphTH(hypoType, h1Type, testType, statT, teststat, 0, 1, f, g, h, pvalue);
          }
          else {
            h = alpha;  
            f = stdnormal_inv(h, info);
            g = 5;
            pvalue = stdnormal_cdf(teststat);
            drawNormalGraphTH(hypoType, h1Type, testType, statT, teststat, 0, 1, f, g, h, pvalue);
          }
        }
        else { // t-test
          if (h1Type == 1) {
            h = alpha / 2;  
            f = t_inv(h, df, info);
            g = -f;
            if (teststat < 0) pvalue = 2 * t_cdf(teststat, df, info);
            else  pvalue = 2 * (1 - t_cdf(teststat, df, info));
            drawTdistGraphTH(hypoType, h1Type, testType, statT, teststat, df, f, g, h, pvalue);
          }
          else if (h1Type == 2) {
            h = alpha;  
            f = -5;   //t_inv(0.0001, df, info);
            g = t_inv(1-h, df, info);
            pvalue = 1 - t_cdf(teststat, df, info);
            drawTdistGraphTH(hypoType, h1Type, testType, statT, teststat, df, f, g, h, pvalue);
          }
          else {
            h = alpha;  
            f = t_inv(h, df, info);
            g = 5;    //t_inv(0.9999, df, info);
            pvalue = t_cdf(teststat, df, info);
            drawTdistGraphTH(hypoType, h1Type, testType, statT, teststat, df, f, g, h, pvalue);
          }
             
        }

      })


      // 모분산 가설검정
      d3.select("#testS1").on("click",function() {
        graphNum = 22;
        if (numVar > 1) {
          alert(alertMsg[37][langNum]); 
          return;
        };
        dataClassifyM();
        if (checkData == false || checkVarSelect == false || checkNumeric == false || checkMissing == true) return;

        buttonColorChange();
        THsigma1 = true;
        document.getElementById("testS1").style.backgroundColor = buttonColorH;
        TotalStat(dobs, dvar, tstat);       

        document.getElementById("sub9").style.display = "block";  //가설검정 선택사항표시

        hypoType = 2;
        h1Type   = 1;
        alpha    = 0.05;
        h        = alpha / 2;  
        nn       = tstat[0];
        df       = nn - 1;
        stdev    = tstat[2]; 
        vari     = stdev * stdev
        variS    = vari;
        teststat = (xbar - mu) / (stdev / Math.sqrt(nn));
        temp = t_inv(1 - alpha/2, df, info) * stdev / Math.sqrt(nn);
        left  = xbar - temp;
        right = xbar + temp;  

        // confidence interval
        left  = df * variS / chisq_inv(1 - alpha/2, df, info);
        right = df * variS / chisq_inv(alpha/2, df, info);

        // test statistics
        teststat = df *  variS / vari;

        statT[0] = variS;    // 초기 variance
        statT[2] = alpha;
        statT[3] = tstat[0]; // nn
        statT[4] = tstat[1]; // xbar
        statT[5] = tstat[2]; // stdev
        statT[6] = left;
        statT[7] = right;

        chart.selectAll("*").remove();

        if (isNaN(vari) || isNaN(nn) || isNaN(variS) || vari <= 0 || nn < 2 || variS <= 0 ) {  // wrong input
          chart.append("text").attr("class","mean").attr("x", 150) .attr("y", 100)
             .text("No input or wrong input !!   Try again.").style("stroke","red")
          return;
        }
        else { // chisq-test
          if (h1Type == 1) {
            h = alpha / 2;  
            f = chisq_inv(h, df, info);
            g = chisq_inv(1-h, df, info);
            pvalue = chisq_cdf(teststat, df, info);
            if (pvalue > 0.5 ) pvalue = 1 - pvalue; 
            pvalue = 2 * pvalue;
            drawChisqGraphTH(hypoType, h1Type, statT, teststat, df, f, g, h, pvalue);
          }
          else if (h1Type == 2) {
            h = alpha;  
            if (df < 10) f = 0;
            else f = chisq_inv(0.0001, df, info);
            g = chisq_inv(1-h, df, info);
            pvalue = 1 - chisq_cdf(teststat, df, info);
            drawChisqGraphTH(hypoType, h1Type, statT, teststat, df, f, g, h, pvalue);
          }
          else {
            h = alpha;  
            f = chisq_inv(h, df, info);
            if (df < 5) g = 12;
            else if (df < 10) g = 30;
            else g = chisq_inv(0.9999, df, info);
            pvalue = chisq_cdf(teststat, df, info);
            drawChisqGraphTH(hypoType, h1Type, statT, teststat, df, f, g, h, pvalue);
          }         
        }
      })

      // 모분산 가설검정 재실행
        // H1 type
        var h9 = document.myForm90.type0;
        h9[0].onclick = function() { h1Type = 1 }    // 양측검정
        h9[1].onclick = function() { h1Type = 2 }    // 우측검정
        h9[2].onclick = function() { h1Type = 3 }    // 좌측검정

        // alpha
        var a9 = document.myForm92.type2;
        a9[0].onclick = function() { alpha = 0.05; }  
        a9[1].onclick = function() { alpha = 0.01; }  

      d3.select("#executeTH9").on("click",function() {
        graphNum = 22;
        // input value
        vari  = parseFloat(d3.select("#vari9").node().value);
        if (isNaN(vari)) {
            alert(alertMsg[40][langNum]); 
            return;
        }

        // confidence interval
        left  = df * variS / chisq_inv(1 - alpha/2, df, info)
        right = df * variS / chisq_inv(alpha/2, df, info)

        // test statistics
        teststat = df *  variS / vari;

        statT[0] = vari;    // 초기 variance
        statT[2] = alpha;
        statT[3] = tstat[0]; // nn
        statT[4] = tstat[1]; // xbar
        statT[5] = tstat[2]; // stdev
        statT[6] = left;
        statT[7] = right;

        chart.selectAll("*").remove();
        df    = statT[3] - 1;

        if (isNaN(vari) || isNaN(nn) || isNaN(variS) || vari <= 0 || nn < 2 || variS <= 0 ) {  // wrong input
          chart.append("text").attr("class","mean").attr("x", 150).attr("y", 100)
             .text("No input or wrong input !!   Try again.").style("stroke","red");
          return;
        }
        else { // chisq-test
          if (h1Type == 1) {
            h = alpha / 2;  
            f = chisq_inv(h, df, info);
            g = chisq_inv(1-h, df, info);
            pvalue = chisq_cdf(teststat, df, info);
            if (pvalue > 0.5 ) pvalue = 1 - pvalue; 
            pvalue = 2 * pvalue;
            drawChisqGraphTH(hypoType, h1Type, statT, teststat, df, f, g, h, pvalue);
          }
          else if (h1Type == 2) {
            h = alpha;  
            if (df < 10) f = 0;
            else f = chisq_inv(0.0001, df, info);
            g = chisq_inv(1-h, df, info);
            pvalue = 1 - chisq_cdf(teststat, df, info);
            drawChisqGraphTH(hypoType, h1Type, statT, teststat, df, f, g, h, pvalue);
          }
          else {
            h = alpha;  
            f = chisq_inv(h, df, info);
            if (df < 5) g = 12;
            else if (df < 10) g = 30;
            else g = chisq_inv(0.9999, df, info);
            pvalue = chisq_cdf(teststat, df, info);
            drawChisqGraphTH(hypoType, h1Type, statT, teststat, df, f, g, h, pvalue);
          }         
        }
      })

      // 두 모평균 가설검정
      d3.select("#testM12").on("click",function() {
        graphNum = 23; 
        if (numVar < 2) {
          alert(alertMsg[41][langNum]); 
          return;
        };

        dataClassifyM();
        if (checkData == false || checkVarSelect == false || checkNumeric == false || checkMissing == true) return;

        buttonColorChange();
        THmean12 = true;
        document.getElementById("testM12").style.backgroundColor = buttonColorH;
        TotalStat(dobs, dvar, tstat);    
        GroupStat(ngroup, nobs, dataSet, mini, Q1, median, Q3, maxi, avg, std);    

        chart.selectAll("*").remove();
        document.getElementById("sub10").style.display = "block";  //가설검정 선택사항표시

        hypoType = 41;
        h1Type = 1; 
        testType = 1;
        alpha = 0.05; 

        mu    = 0;
        nn1   = nobs[0];
        xbar1 = avg[0];
        var1  = std[0]*std[0];
        nn2   = nobs[1];
        xbar2 = avg[1];
        var2  = std[1]*std[1];

        // test statistics
        df  = nn1 + nn2 - 2;
        df1 = nn1 - 1;
        df2 = nn2 - 1;
        varPooled = ( df1*var1 + df2*var2 ) / df;
        t1 = var1 / nn1;
        t2 = var2 / nn2;
        varAdd    = t1 + t2;
        if (testType == 1) teststat = (xbar1 - xbar2 - mu) / Math.sqrt(varPooled/nn1 + varPooled/nn2); 
        else teststat = (xbar1 - xbar2 - mu) / Math.sqrt(varAdd);
        
        statT[0] = mu;      // 초기 D
        if (testType == 1) statT[1] = Math.sqrt(varPooled/nn1 + varPooled/nn2);
        else statT[1] = Math.sqrt(varAdd);
        statT[2] = alpha;
        statT[3] = nn1;
        statT[4] = xbar1;
        statT[5] = std[0];
        statT[6] = nn2;
        statT[7] = xbar2;
        statT[8] = std[1];

        chart.selectAll("*").remove();

        if (isNaN(nn1) || isNaN(nn2) || isNaN(xbar1) || isNaN(xbar2) || isNaN(var1) || isNaN(var2) ||
            nn1 < 2 || nn2 < 2 || var1 <= 0 || var2 <= 0) {  // wrong input
            chart.append("text").attr("class","mean").attr("x", 150).attr("y", 100)
             .text("No input or wrong input !!   Try again.").style("stroke","red");
            return;
        }
        else {    // t-test        
          if (h1Type == 1) {
            h = alpha / 2;  
            if (testType == 1) {
              f = t_inv(h, df, info);
              g = -f;
              if (teststat < 0) pvalue = 2 * t_cdf(teststat, df, info);
              else  pvalue = 2 * (1 - t_cdf(teststat, df, info));
            }
            else if (testType == 2) {
              f = (t1*t_inv(h, df1, info) + t2*t_inv(h, df2, info)) / varAdd;
              g = -f;
              if (teststat < 0)  pvalue = 2 * (t1*t_cdf(teststat, df1, info) + t2*t_cdf(teststat, df2, info)) / varAdd;
              else  pvalue = 2 * (1 - (t1*t_cdf(teststat, df1, info) + t2*t_cdf(teststat, df2, info)) / varAdd );
            }
            drawTdistGraphTH(hypoType, h1Type, testType, statT, teststat, df, f, g, h, pvalue);
          }
          else if (h1Type == 2) {
            h = alpha; 
            if (testType == 1) {             
              f = t_inv(0.0001, df, info);
              g = t_inv(1-h, df, info);
              pvalue = 1 - t_cdf(teststat, df, info);
            }
            else if (testType == 2) {
              f = t_inv(0.0001, df, info);
              g = (t1*t_inv(1-h, df1, info) + t2*t_inv(1-h, df2, info)) / varAdd;
              pvalue = 1 - ( (t1*t_cdf(teststat, df1, info) + t2*t_cdf(teststat, df2, info)) / varAdd );
            }
            drawTdistGraphTH(hypoType, h1Type, testType, statT, teststat, df, f, g, h, pvalue);
          }
          else {
            h = alpha; 
            if (testType == 1) { 
              f = t_inv(h, df, info);
              g = t_inv(0.9999, df, info);
              pvalue = t_cdf(teststat, df, info);
            }
            else if (testType == 2) {
              f = (t1*t_inv(h, df1, info) + t2*t_inv(h, df2, info)) / varAdd;
              g = t_inv(0.9999, df, info);
              pvalue = (t1*t_cdf(teststat, df1, info) + t2*t_cdf(teststat, df2, info)) / varAdd ;
            }
            drawTdistGraphTH(hypoType, h1Type, testType, statT, teststat, df, f, g, h, pvalue);
          }          
        }

      })

      // 가설검정 Mu 12 재실행
        // H1 type
        var h10 = document.myForm100.type0;
        h10[0].onclick = function() { h1Type = 1 }    // 양측검정
        h10[1].onclick = function() { h1Type = 2 }    // 우측검정
        h10[2].onclick = function() { h1Type = 3 }    // 좌측검정

        // Test type
        var test10 = document.myForm101.type1;
        test10[0].onclick = function() { testType = 1; hypoType = 41 }  // same population variance
        test10[1].onclick = function() { testType = 2; hypoType = 42 }  // not same population variances

        // alpha
        var a10 = document.myForm102.type2;
        a10[0].onclick = function() { alpha = 0.05; }  
        a10[1].onclick = function() { alpha = 0.01; }  

      d3.select("#executeTH10").on("click",function() {
        graphNum = 23;
        mu    = parseFloat(d3.select("#mu10").node().value);
        nn1   = nobs[0];
        xbar1 = avg[0];
        var1  = std[0]*std[0];
        nn2   = nobs[1];
        xbar2 = avg[1];
        var2  = std[1]*std[1];
 
        // test statistics
        df  = nn1 + nn2 - 2;
        df1 = nn1 - 1;
        df2 = nn2 - 1;
        varPooled = ( df1*var1 + df2*var2 ) / df;
        t1 = var1 / nn1;
        t2 = var2 / nn2;
        varAdd    = t1 + t2;
        if (testType == 1) teststat = (xbar1 - xbar2 - mu) / Math.sqrt(varPooled/nn1 + varPooled/nn2); 
        else teststat = (xbar1 - xbar2 - mu) / Math.sqrt(varAdd);

        statT[0] = mu;      // 초기 D
        if (testType == 1) statT[1] = Math.sqrt(varPooled/nn1 + varPooled/nn2);
        else statT[1] = Math.sqrt(varAdd);
        statT[2] = alpha;
        statT[3] = nn1;
        statT[4] = xbar1;
        statT[5] = std[0];
        statT[6] = nn2;
        statT[7] = xbar2;
        statT[8] = std[1];

        chart.selectAll("*").remove();
        
        if (isNaN(nn1) || isNaN(nn2) || isNaN(xbar1) || isNaN(xbar2) || isNaN(var1) || isNaN(var2) ||
            nn1 < 2 || nn2 < 2 || var1 <= 0 || var2 <= 0) {  // wrong input
          chart.append("text").attr("class","mean").attr("x", 150).attr("y", 100)
             .text("No input or wrong input !!   Try again.") .style("stroke","red");
          return;
        }
        else {    // t-test        
          if (h1Type == 1) {
            h = alpha / 2;  
            if (testType == 1) {
              f = t_inv(h, df, info);
              g = -f;
              if (teststat < 0) pvalue = 2 * t_cdf(teststat, df, info);
              else  pvalue = 2 * (1 - t_cdf(teststat, df, info));
            }
            else if (testType == 2) {
              f = (t1*t_inv(h, df1, info) + t2*t_inv(h, df2, info)) / varAdd;
              g = -f;
              if (teststat < 0)  pvalue = 2 * (t1*t_cdf(teststat, df1, info) + t2*t_cdf(teststat, df2, info)) / varAdd;
              else  pvalue = 2 * (1 - (t1*t_cdf(teststat, df1, info) + t2*t_cdf(teststat, df2, info)) / varAdd );
            }
            drawTdistGraphTH(hypoType, h1Type, testType, statT, teststat, df, f, g, h, pvalue);
          }
          else if (h1Type == 2) {
            h = alpha; 
            if (testType == 1) {             
              f = t_inv(0.0001, df, info);
              g = t_inv(1-h, df, info);
              pvalue = 1 - t_cdf(teststat, df, info);
            }
            else if (testType == 2) {
              f = t_inv(0.0001, df, info);
              g = (t1*t_inv(1-h, df1, info) + t2*t_inv(1-h, df2, info)) / varAdd;
              pvalue = 1 - ( (t1*t_cdf(teststat, df1, info) + t2*t_cdf(teststat, df2, info)) / varAdd );
            }
            drawTdistGraphTH(hypoType, h1Type, testType, statT, teststat, df, f, g, h, pvalue);
          }
          else {
            h = alpha; 
            if (testType == 1) { 
              f = t_inv(h, df, info);
              g = t_inv(0.9999, df, info);
              pvalue = t_cdf(teststat, df, info);
            }
            else if (testType == 2) {
              f = (t1*t_inv(h, df1, info) + t2*t_inv(h, df2, info)) / varAdd;
              g = t_inv(0.9999, df, info);
              pvalue = (t1*t_cdf(teststat, df1, info) + t2*t_cdf(teststat, df2, info)) / varAdd ;
            }
            drawTdistGraphTH(hypoType, h1Type, testType, statT, teststat, df, f, g, h, pvalue);
          }          
        }

      })

      // 두 모분산 가설검정
      d3.select("#testS12").on("click",function() {
        graphNum = 24;
        if (numVar < 2) {
          alert(alertMsg[41][langNum]); 
          return;
        };

        dataClassifyM();
        if (checkData == false || checkVarSelect == false || checkNumeric == false || checkMissing == true) return;

        buttonColorChange();
        THsigma12 = true;
        document.getElementById("testS12").style.backgroundColor = buttonColorH;
        TotalStat(dobs, dvar, tstat);    
        GroupStat(ngroup, nobs, dataSet, mini, Q1, median, Q3, maxi, avg, std);    

        chart.selectAll("*").remove();
        document.getElementById("sub11").style.display = "block";  //가설검정 선택사항표시

        hypoType = 5;
        h1Type = 1; 
        alpha = 0.05; 

        nn1   = nobs[0];
        nn2   = nobs[1];
        df1   = nn1 - 1;
        df2   = nn2 - 1;
        var1  = std[0]*std[0];
        var2  = std[1]*std[1];

        // test statistics
        teststat  = var1 / var2;

        statF[0] = teststat;
        statF[2] = alpha;
        statF[3] = nobs[0]; // nn1
        statF[4] = avg[0];  // xbar1
        statF[5] = std[0];  // std1
        statF[6] = nobs[1]; // nn2
        statF[7] = avg[1];  // xbar2
        statF[8] = std[1];  // std2

        chart.selectAll("*").remove();

        if (isNaN(nn1) || isNaN(nn2) || isNaN(var1) || isNaN(var2) ||
               nn1 < 2 || nn2 <2 || var1 <= 0 || var2 <= 0) {  // wrong input
          chart.append("text").attr("class","mean").attr("x", 150).attr("y", 100)
             .text("No input or wrong input !!   Try again.").style("stroke","red");
          return;
        }
        else { // F-test
          if (h1Type == 1) {
            h = alpha / 2;  
            f = f_inv(h, df1, df2, info);
            g = f_inv(1-h, df1, df2, info);
            pvalue = f_cdf(teststat, df1, df2, info);
            if (pvalue > 0.5) pvalue = 1 - pvalue;
            pvalue = 2 * pvalue;
            drawFdistGraphTH(hypoType, h1Type, statF, df1, df2, f, g, h, pvalue);
          }
          else if (h1Type == 2) {
            h = alpha;  
            f = 0;
            g = f_inv(1-h, df1, df2, info);
            pvalue = 1 - f_cdf(teststat, df1, df2, info);
            drawFdistGraphTH(hypoType, h1Type, statF, df1, df2, f, g, h, pvalue);
          }
          else {
            h = alpha;  
            f = f_inv(h, df1, df2, info);
            g = 10;
            pvalue = f_cdf(teststat, df1, df2, info);
            drawFdistGraphTH(hypoType, h1Type, statF, df1, df2, f, g, h, pvalue);
          }          
        }

      })

      // 두 모분산 가설검정 재실행
        // H1 type
        var h11 = document.myForm110.type0;
        h11[0].onclick = function() { h1Type = 1 }    // 양측검정
        h11[1].onclick = function() { h1Type = 2 }    // 우측검정
        h11[2].onclick = function() { h1Type = 3 }    // 좌측검정

        // alpha
        var a11 = document.myForm112.type2;
        a11[0].onclick = function() { alpha = 0.05; }  
        a11[1].onclick = function() { alpha = 0.01; }  

      d3.select("#executeTH11").on("click",function() {
        graphNum = 24;
        hypoType = 5;

        nn1   = nobs[0];
        nn2   = nobs[1];
        df1   = nn1 - 1;
        df2   = nn2 - 1;
        var1  = std[0]*std[0];
        var2  = std[1]*std[1];
 
        // test statistics
        teststat = var1 / var2;

        statF[0] = teststat;
        statF[2] = alpha;
        statF[3] = nobs[0]; // nn1
        statF[4] = avg[0];  // xbar1
        statF[5] = std[0];  // std1
        statF[6] = nobs[1]; // nn2
        statF[7] = avg[1];  // xbar2
        statF[8] = std[1];  // std2

        chart.selectAll("*").remove();

        if (isNaN(nn1) || isNaN(nn2) || isNaN(var1) || isNaN(var2) ||
               nn1 < 2 || nn2 <2 || var1 <= 0 || var2 <= 0) {  // wrong input
          chart.append("text").attr("class","mean").attr("x", 150).attr("y", 100)
             .text("No input or wrong input !!   Try again.").style("stroke","red");
          return;
        }
        else { // F-test

          if (h1Type == 1) {
            h = alpha / 2;  
            f = f_inv(h, df1, df2, info);
            g = f_inv(1-h, df1, df2, info);
            pvalue = f_cdf(teststat, df1, df2, info);
            if (teststat > 0.5) pvalue = 1 - pvalue;
            pvalue = 2 * pvalue;
            if (pvalue > 1.0) pvalue = 1.0;
            drawFdistGraphTH(hypoType, h1Type, statF, df1, df2, f, g, h, pvalue, ngroup, nobs, avg, std);
          }
          else if (h1Type == 2) {
            h = alpha;  
            f = 0;
            g = f_inv(1-h, df1, df2, info);
            pvalue = 1 - f_cdf(teststat, df1, df2, info);
            drawFdistGraphTH(hypoType, h1Type, statF, df1, df2, f, g, h, pvalue, ngroup, nobs, avg, std);
          }
          else {
            h = alpha;  
            f = f_inv(h, df1, df2, info);
            g = 10;
            pvalue = f_cdf(teststat, df1, df2, info);
            drawFdistGraphTH(hypoType, h1Type, statF, df1, df2, f, g, h, pvalue, ngroup, nobs, avg, std);
          }          
        }

      })

      // 분산분석
      d3.select("#anova").on("click",function() {
        graphNum = 25;
        if (numVar < 2) {
          alert(alertMsg[41][langNum]); 
          return;
        };

        dataClassifyM();
        if (checkData == false || checkVarSelect == false || checkNumeric == false || checkMissing == true) return;

        buttonColorChange();
        THanova = true;
        document.getElementById("anova").style.backgroundColor = buttonColorH;
        TotalStat(dobs, dvar, tstat);    
        GroupStat(ngroup, nobs, dataSet, mini, Q1, median, Q3, maxi, avg, std);    

        chart.selectAll("*").remove();
        document.getElementById("sub12").style.display = "block";  //가설검정 선택사항표시

        hypoType = 7;
        h1Type = 2; 
        alpha = 0.05; 

        var strnn   = "";
        var strxbar = "";
        var strstd  = "";
        checkData = true;
        for (i=0; i<ngroup; i++) {
          strnn   += " n"+(i+1).toString()+"="+nobs[i].toString()+", ";
          strxbar += " m"+(i+1).toString()+"="+(f2(avg[i])).toString()+", ";
          strstd  += " s"+(i+1).toString()+"="+(f2(std[i])).toString()+", ";
        } 

        chart.selectAll("*").remove();
    
        // ANOVA F-test statistics
          df1  = ngroup - 1;
          ntot = 0;
          ssb  = 0;
          ssw  = 0;
          for (i=0; i<ngroup; i++) ntot += nobs[i]; 
          df2  = ntot - ngroup;

          // total mean
          mtot = 0;
          for (i=0; i<ngroup; i++) mtot += nobs[i] * avg[i];
          mtot /= ntot;

          // between & within sum of squares
          ssb = 0;
          ssw = 0;
          for (i=0; i<ngroup; i++) {
            temp = (avg[i]-mtot);
            ssb += nobs[i] * temp*temp;
            ssw += (nobs[i] - 1) * std[i]*std[i];
          }
        
          msb = ssb / df1;
          msw = ssw / df2;

          statF[0] = msb / msw;
          statF[1] = ssb;
          statF[2] = ssw;
          statF[3] = ssb + ssw;
          statF[4] = msb;
          statF[5] = msw;

          h = alpha;  
          f = 0;
          g = f_inv(1-h, df1, df2, info);
          pvalue = 1 - f_cdf(statF[0], df1, df2, info);
          drawFdistGraphTH(hypoType, h1Type, statF, df1, df2, f, g, h, pvalue, ngroup, nobs, avg, std);
      })


      // 분산분석 재실행
      // 분산분석 재실행 alpha
        var a12 = document.myForm122.type2;
        a12[0].onclick = function() { alpha = 0.05; }  
        a12[1].onclick = function() { alpha = 0.01; }  

      d3.select("#executeTH12").on("click",function() {
        graphNum = 25;

        chart.selectAll("*").remove();
        hypoType = 7;
        h1Type = 2; 
   
        // ANOVA F-test statistics
          df1  = ngroup - 1;
          ntot = 0;
          ssb  = 0;
          ssw  = 0;
          for (i=0; i<ngroup; i++) ntot += nobs[i]; 
          df2  = ntot - ngroup;

          // total mean
          mtot = 0;
          for (i=0; i<ngroup; i++) mtot += nobs[i] * avg[i];
          mtot /= ntot;

          // between & within sum of squares
          ssb = 0;
          ssw = 0;
          for (i=0; i<ngroup; i++) {
            temp = (avg[i]-mtot);
            ssb += nobs[i] * temp*temp;
            ssw += (nobs[i] - 1) * std[i]*std[i];
          }
        
          msb = ssb / df1;
          msw = ssw / df2;

          statF[0] = msb / msw;
          statF[1] = ssb;
          statF[2] = ssw;
          statF[3] = ssb + ssw;
          statF[4] = msb;
          statF[5] = msw;

          h = alpha;  
          f = 0;
          g = f_inv(1-h, df1, df2, info);
          pvalue = 1 - f_cdf(statF[0], df1, df2, info);
          drawFdistGraphTH(hypoType, h1Type, statF, df1, df2, f, g, h, pvalue, ngroup, nobs, avg, std);
 
      })

      // 시트 변량편집


      // 그래프 제목편집
      d3.select("#editGraph").on("click",function() {
        if (graphNum > 20) {
          alert(alertMsg[42][langNum]); 
          return;
        }
        buttonColorChange();
        EditGraph = true;
        document.getElementById("editGraph").style.backgroundColor = buttonColorH;
        document.getElementById("sub13").style.display = "block";  //그래프 제목편집 선택사항표시   

        // 현재 제목 쓰기
        d3.select("#titleMain").node().value = mTitle[graphNum];
        d3.select("#titleY").node().value    = yTitle[graphNum];
        d3.select("#titleX").node().value    = xTitle[graphNum];
      })

      // 그래프 제목편집 실행
      d3.select("#executeTH13").on("click",function() {
        mTitle[graphNum] = d3.select("#titleMain").node().value;
        yTitle[graphNum] = d3.select("#titleY").node().value;
        xTitle[graphNum] = d3.select("#titleX").node().value;
        redrawGraph(graphNum);
      })

      // jQuery 대화상자 초기화?
      $(".dialog").dialog({
        autoOpen: false,
        modal: true,
      });

      // 변량 편집 버튼 : V1 (jj=0) 만 해당
      d3.select("#variableBtn").on("click",function() {
        variableSelectClear();
        jj = 0;
        document.getElementById("varlist").value = 1;
        buttonColorChange();

	$("#sub14").dialog("open");

        selectVarInit();

      })

      // 편집창 varlist에 이벤트 발생시 update 처리 함수 --------------------------
      function selectVarUpdate() {
        // 변량명을 rvarName에 입력
        rvarName[jj] = d3.select("#vname").node().value;
        // 변량값명을 rvaluelabel에 입력  : rvalueNum[jj]가 증가할 수도 있음
        rvalueNum[jj] = 0;
        for (k = 0; k < maxNumEdit; k++) {            
            str1 = "#cell"+(k+1).toString()+(1).toString();
            str2 = "#cell"+(k+1).toString()+(2).toString();
            temp = d3.select(str1).node().value;
            if ( temp == "" ) {break;}
            else {
              rvalueNum[jj] ++;
              rvalue[jj][k] = temp;
              rvalueLabel[jj][k] = d3.select(str2).node().value;
            }      
        }

        jj = parseInt(document.getElementById("varlist").value) - 1;
        selectVarInit();

      } // endof selectVarUpdate()  ---------------------------------------------

      // 편집창 varlist에 초기값 표시 함수 ---------------------------------------
      function selectVarInit() {
        // 변량명 초기화  
        d3.select("#vname").node().value = rvarName[jj];
        // 편집창 셀에 변량값 입력
        for (k = 0; k < maxNumEdit; k++) {
          str1 = "#cell"+(k+1).toString()+(1).toString();
          str2 = "#cell"+(k+1).toString()+(2).toString();
          if (k < rvalueNum[jj]) {
            d3.select(str1).node().value = rvalue[jj][k];
            d3.select(str2).node().value = rvalueLabel[jj][k];
          }
          else {
            d3.select(str1).node().value = null;
            d3.select(str2).node().value = null;
          }
        }
      } // endof selectVarInit -------------------------------------------------

      // 변량편집 저장 (최종 편집 변량에 적용)
      d3.select("#vconfirm").on("click",function() {
        selectVarUpdate();
        datasheet.updateSettings({
           colHeaders: rvarName
        });      
      })

      // 변량편집 나가기
      d3.select("#vcancel").on("click",function() { 
        selectVarUpdate();
        datasheet.updateSettings({
           colHeaders: rvarName
        });   
	$("#sub14").dialog("close");
      })

</script>
</body>
</html>
