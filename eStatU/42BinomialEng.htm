<!DOCTYPE html>
<html>

<head>
  <title>Binomial Distribution</title>
  <link rel="stylesheet" href="eStat.css">
  <script src="d3.v4.min.js"></script>
  <script src="DistributionsUtil.js" ></script>
  <script src="eStatU.js" ></script>
</head>

<body>

  <div width="600" height="600" style="position:absolute; left:10px; top:0px">
    <br>
    <div class="title">
      &nbsp; <b> Binomial Distribution</b> 
      <a class="menu" href="eStatU.htm"><b>Menu</b></a>  
    </div>
    <br>
    <svg id="chart2" width="600" height="600"> </svg> <br>
    <input type="button" value="Execute" size=1 id="execute2Binomial"> &nbsp;
      n = <input type="text" class="textarea" value="10"   size=3 id="nn2">&nbsp;<sup><small> 1 </small></sup>  
    <input type="range" min="1" max="100" value="10" id="range3Binomial" onchange="showValueBinomial3(this.value, valueLabel, binomialP2)"/>  
      <sup><small>100</small></sup>  &nbsp;&nbsp;
      p = <input type="text" class="textarea" value="0.5" size=3 id="pp2"><sup><small> 0 </small></sup> 
    <input type="range" min="1" max="99" value="50" id="range4Binomial" onchange="showValueBinomial4(this.value, valueLabel, binomialP2)"/>
      <sup><small> 1 </small></sup> <p>   
      <input type="button" value="Binomial Prob Table" size=3 id="execute3Binomial"> 
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <label><input type="checkbox" value="freq2" id=freq2Binomial>show probability</label> &nbsp;
      <label><input type="checkbox" value="freq3" id=freq3Binomial>Normal approx</label> (n>=10)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <p>
    References:  &nbsp; 
      <a href="https://en.wikipedia.org/wiki/Binomial_distribution" target="_blank" >Wikipedia </a> &nbsp; 
      <a href="http://mathworld.wolfram.com/BinomialDistribution.html" target="_blank" >Wolfram </a> &nbsp; 
      <a href="https://stattrek.com/probability-distributions/binomial.aspx" target="_blank" >StatTrek </a> &nbsp; 
  </div>

  <div width="650" style="position:absolute; left:10px; top:770px"> <p>
    <table id="binomTable" cellpadding="2" cellspacing="2" border="2" >  </table>
  </div>

  <script>

      var bar = d3.select("#chart2");

      // 이항분포 시뮬레이션 초기화면 셋팅
      var i, j, k, sum, temp, info;
      var nn2, pp2, avg,  std, savg, sstd;
      var xmin, xmax, ymin, ymax, gxmin, gxmax, gxrange, gymin, gymax, gyrange;
      var nobs;
      var nvalueMax  = 31;
      var binomialP2 = new Array(nvalueMax);
      var valueLabel = new Array(nvalueMax);

      var checkFreq2   = false;
      var checkFreq3   = false;

      var margin      = {top: 50, bottom: 60, left: 40, right: 40};
      var svgWidth    = 600;
      var svgHeight   = 600;
      var graphWidth  = svgWidth - margin.left - margin.right;
      var graphHeight = svgHeight - margin.top - margin.bottom;

      nn2 = parseFloat(d3.select("#nn2").node().value);    // 크기 n
      pp2 = parseFloat(d3.select("#pp2").node().value);    // 성공확률 p
      nvalue2 = nn2 + 1;
      xmin      = 0;
      xmax      = nvalue2;
      ymin      = 0;
      if ( nn2 > 9 && pp2 >= 0.1 && pp2 <= 0.9) ymax = 0.3;
      else ymax = 0.8;

      drawBinomialBarGraph(nn2, pp2, binomialP2, xmin, xmax, ymin, ymax, valueLabel);


      // 이항분포 실행버튼 클릭 =================================================================================
      d3.select("#execute2Binomial").on("click",function() {
        bar.selectAll("*").remove();
        document.getElementById("freq2Binomial").checked = false;
        document.getElementById("freq3Binomial").checked = false;
        checkFreq2 = false;
        checkFreq3 = false;
        removeBinomialFreq2();
        removeBinomialNormal();

        nn2 = parseFloat(d3.select("#nn2").node().value);    // 크기 n
        pp2 = parseFloat(d3.select("#pp2").node().value);    // 성공확률 p
        if (nn2 < 1 )   nn2 = 1;
        if (nn2 > 100)  nn2 = 100;
        if (pp2 < 0.01) pp2 = 0.01;
        if (pp2 > 0.99) pp2 = 0.99;
        // slider control
        document.getElementById("range3Binomial").value  = nn2;
        document.getElementById("range4Binomial").value  = 100*pp2;

        nvalue2 = nn2+1;
        drawBinomialBarGraph(nn2, pp2, binomialP2, xmin, xmax, ymin, ymax, valueLabel);

        if (checkFreq2) showBinomialFreq2(nvalue2, binomialP2, xmin, xmax, ymin, ymax);
        if (checkFreq3 && nvalue2 > 9) showBinomialNormal(nn2, pp2, xmin, xmax, ymin, ymax);
      })

      // 이항분포 확률표시 버튼 클릭
      d3.select("#freq2Binomial").on("click",function() {
        if(this.checked) {
          checkFreq2  = true;
          nn2 = parseFloat(d3.select("#nn2").node().value);    // 크기 n
          pp2 = parseFloat(d3.select("#pp2").node().value);    // 성공확률 p
          xmin      = 0;
          xmax      = nvalue2;
          ymin      = 0;
          if ( nn2 > 9 && pp2 >= 0.1 && pp2 <= 0.9) ymax = 0.3;
          else ymax = 0.8;
          // 확률및 통계량 계산
          for (var i=0; i<nvalue2; i++) {
            binomialP2[i] = binomial_pdf(i, nn2, pp2, info)
          }
          showBinomialFreq2(nn2+1, binomialP2, xmin, xmax, ymin, ymax);
        } else {
          checkFreq2 = false;
	  removeBinomialFreq2();
        }
      })

      // 정규분포근사 버튼 클릭
      d3.select("#freq3Binomial").on("click",function() {
        if(this.checked) {
          checkFreq3 = true;
          nn2 = parseFloat(d3.select("#nn2").node().value);    // 크기 n
          pp2 = parseFloat(d3.select("#pp2").node().value);    // 성공확률 p
          xmin      = 0;
          xmax      = nvalue2;
          ymin      = 0;
          if ( nn2 > 9 && pp2 >= 0.1 && pp2 <= 0.9) ymax = 0.3;
          else ymax = 0.8;
          if (nn2 > 9) showBinomialNormal(nn2, pp2, xmin, xmax, ymin, ymax);
        } else {
          checkFreq3 = false;
	  removeBinomialNormal();
        }
      })

      // 이항분포표 버튼 클릭
      d3.select("#execute3Binomial").on("click",function() {
          nn2 = parseFloat(d3.select("#nn2").node().value);    // 크기 n
          pp2 = parseFloat(d3.select("#pp2").node().value);    // 성공확률 p
          binomialTable(nn2, pp2, binomialP2);
      })

  </script>
</body>
</html>
