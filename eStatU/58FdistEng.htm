<!DOCTYPE html>
<html>

<head>
  <title>F Distribution</title>
  <link rel="stylesheet" href="eStat.css">
  <script src="d3.v4.min.js"></script>
  <script src="DistributionsUtil.js" ></script>
  <script src="eStatU.js" ></script>
</head>

<body>
  <div width="600" height="410" style="position:absolute; left:10px; top:0px">
    <br>
    <div class="title">
      <b>&nbsp; F Distribution</b> 
      <a class="menu" href="eStatU.htm"><b>Menu</b></a>  
    </div>
    <br>
 
    &nbsp; df1 =  <input type="text" class="textarea" value="5"  size=2 id="df1"> 
    <sup><small>1 </small></sup>
    <input type="range" min="1" max="100" value="5" class="sliderS" id="range1F" onchange="showValueF01(this.value)"/>
    <sup><small>100 </small></sup> 
    &nbsp; df2 =  <input type="text" class="textarea" value="10"  size=2 id="df2"> 
    <sup><small>1 </small></sup>
    <input type="range" min="1" max="100" value="10"  class="sliderS" id="range2F" onchange="showValueF02(this.value)"/>
    <sup><small>100 </small></sup> &nbsp; &nbsp; 
    <input type="button" value="Calculate" size=10 id="executeF"> <p>

    <svg id="chart" width="600" height="400"> </svg> 

    <section class="range-slider">
    <input value="5"  min="0" max="100" type="range" onchange="showValueF1(this.value)"/>
    <input value="30" min="0" max="100" type="range" onchange="showValueF2(this.value)"/>
    </section>
 
    <form name="myForm"> 
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <input type="radio" name = "type1" value="1" checked> 
         P( &nbsp; <input type="text" class="textarea" value="0.5" size=6  id="a"> &nbsp;  < &nbsp;  F &nbsp; < &nbsp; 
         <input type="text" class="textarea"  value="3"  size=6 id="b">  &nbsp; ) &nbsp;  =   &nbsp; 
         <input type="text" class="textarea2" value="0.7045"  size=14 id="c"> <p> 
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <input type="radio" name = "type1" value="2" > 
         P( &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            &nbsp;&nbsp;&nbsp;&nbsp; F &nbsp; < &nbsp;
         <input type="text" class="textarea2" value="3.3258" size=6  id="d"> &nbsp; ) &nbsp; = &nbsp;
         <input type="text" class="textarea"  value="0.95"  size=14  id="e">  <br>
         &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
         &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
         &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
         &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
         <sup><small>0 </small></sup>
         <input type="range" min="0" max="100" value="95" id="range3F" onchange="showValueF3(this.value)"/>
         <sup><small>1</small> </sup> <br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <input type="radio" name = "type1" value="3" >   
         P( &nbsp; <input type="text" class="textarea2" value="0.1511" size=6  id="f"> &nbsp;  < &nbsp;  F &nbsp; < &nbsp; 
         <input type="text" class="textarea2"  value="4.2361"  size=6 id="g">  &nbsp; ) &nbsp;  =   &nbsp; 
         <input type="text" class="textarea" value="0.95"  size=14 id="h">  <br>
         &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
         &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
         &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
         &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
         <sup><small>0 </small></sup>
         <input type="range" min="0" max="100" value="95" id="range4F" onchange="showValueF4(this.value)"/>
         <sup><small>1</small> </sup> <br>
      References: &nbsp;
      <a href="https://en.wikipedia.org/wiki/F-distribution" target="_blank" >Wikipedia </a> &nbsp; 
      <a href="http://mathworld.wolfram.com/F-Distribution.html" target="_blank" >Wolfram </a> &nbsp; 
      <a href="http://stattrek.com/probability-distributions/f-distribution.aspx" target="_blank" >StatTrek </a> &nbsp; 

    </form>
  </div> 

  <script>

      var bar = d3.select("#chart");

      var svgWidth, svgHeight, margin, graphWidth, graphHeight;
      var svgWidth2, svgHeight2, graphWidth2, graphHeight2;
      svgWidth    = 600;
      svgHeight   = 510;
      svgWidth2   = 600;
      svgHeight2  = 400;

      var nobs, avg, std, gxmin, gxmax, gymin, gymax;
      var stat = new Array(30);
      var title;
      var df1, df2, info, a, b, c, d, e, f, g, h;

      // 초기 F분포 확률 그리기
      df1   = 5;
      df2   = 10;
      a     = 0.5;
      b     = 3;
      c     = f_cdf(b, df1, df2,info) - f_cdf(a, df1, df2, info);
      drawFGraph(df1, df2,  a, b, c);

      // F분포 확률 ------------------------------------------------------------------------------------
      var rad = document.myForm.type1;
      var radioType = 1;
      rad[0].onclick = function() {     // P(a< F < b) = c
          radioType = 1;  
          bar.selectAll("*").remove();
          df1 = parseFloat(d3.select("#df1").node().value);
          df2 = parseFloat(d3.select("#df2").node().value);  
          a = parseFloat(d3.select("#a").node().value); 
          if ( a < 0 ) a = 0.0001;   
          b = parseFloat(d3.select("#b").node().value);
          if ( b > 100 ) b = 100;
          if ( a > b ) c = 0;
          else c = f_cdf(b, df1, df2,  info) - f_cdf(a, df1, df2,  info);
          d3.select("#c").node().value = f4(c);
          drawFGraph(df1, df2,  a, b, c);
      }
      rad[1].onclick = function() {     // P(F < d) = e
          radioType = 2;
          bar.selectAll("*").remove();
          df1 = parseFloat(d3.select("#df1").node().value);
          df2 = parseFloat(d3.select("#df2").node().value);  
          e = parseFloat(d3.select("#e").node().value); 
          d = f_inv(e, df1, df2,  info);
          d3.select("#d").node().value = f4(d);
          drawFGraph(df1, df2,  0, d, e);
      }
      rad[2].onclick = function() {     // P(f < F < g) = h
          radioType = 3;
          bar.selectAll("*").remove();
          df1 = parseFloat(d3.select("#df1").node().value);
          df2 = parseFloat(d3.select("#df2").node().value);  
          h = parseFloat(d3.select("#h").node().value); 
          if (h > 0.999999) {
             f = 0;
             g = 100;
          }
          else {
             g = f_inv(1-(1-h)/2, df1, df2,  info);
             f = f_inv((1-h)/2, df1, df2,  info);
          }
          d3.select("#f").node().value = f4(f);
          d3.select("#g").node().value = f4(g);
          drawFGraph(df1, df2,  f, g, h); 
      }    

      // 확률계산 실행버튼 클릭
      d3.select("#executeF").on("click",function() {
        bar.selectAll("*").remove();

        margin  = {top: 50, bottom: 50, left: 50, right: 20};
        graphWidth2   = svgWidth2 - margin.left - margin.right;
        graphHeight2  = svgHeight2 - margin.top - margin.bottom;
 
        df1 = parseFloat(d3.select("#df1").node().value);
        df2 = parseFloat(d3.select("#df2").node().value);  

        // slider control
        document.getElementById("range1F").value  = df1;
        document.getElementById("range2F").value  = df2;

        if (radioType == 1) {
          bar.selectAll("text.mean").remove();
          bar.selectAll("line.lineb").remove();
          a = parseFloat(d3.select("#a").node().value); 
          if ( a < 0 ) a = 0.0001;   
          b = parseFloat(d3.select("#b").node().value);
          if ( b > 100 ) b = 100;
          if ( a > b ) c = 0;
          else c = f_cdf(b, df1, df2,  info) - f_cdf(a, df1, df2,  info);
          d3.select("#c").node().value = f4(c);
          drawFGraph(df1, df2,  a, b, c);
        } 
        else if (radioType == 2) {
          bar.selectAll("text.mean").remove();
          bar.selectAll("line.lineb").remove();
          e = parseFloat(d3.select("#e").node().value); 
          document.getElementById("range3F").value  = f0(e*100);
          if (e > 0.99999) d = 100;
          else if (e < 0.00001) d = 0.00001;
          else d = f_inv(e, df1, df2,  info);
          d3.select("#d").node().value = f4(d);
          drawFGraph(df1, df2,  0, d, e);
       }
       else if (radioType == 3) {
          bar.selectAll("text.mean").remove();
          bar.selectAll("line.lineb").remove();
          h = parseFloat(d3.select("#h").node().value); 
          document.getElementById("range4F").value  = f0(h*100);
          if (h > 0.999999) {
             f = 0.00001;
             g = 100;
          }
          else {
             g = f_inv(1-(1-h)/2, df1, df2,  info);
             f = f_inv((1-h)/2, df1, df2,  info);
          }
          d3.select("#f").node().value = f4(f);
          d3.select("#g").node().value = f4(g);
          drawFGraph(df1, df2,  f, g, h); 
       }
      })

  </script>
</body>
</html>
